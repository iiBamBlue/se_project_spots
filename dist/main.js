!function(){"use strict";var e="/se_project_spots/";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=e=>{console.error(`Validation Error: ${e}`)},o=(e,t,o)=>{const n=e.querySelector(`#${t.id}-error`);n?(n.textContent="",n.removeAttribute("role"),t.classList.remove(o.inputErrorClass)):r(`Error message element for input ${t.id} not found.`)},n=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?a(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},a=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},c=(e,t,r)=>{t.forEach((t=>{o(e,t,r)}));const n=e.querySelector(r.submitButtonSelector);a(n,r)};function l(e,t,r="Save",o="Saving..."){t.textContent=e?o:r}function s(e,t,r="Saving..."){t.preventDefault();const o=t.submitter,n=o.textContent;return l(!0,o,n,r),e().catch(console.error).finally((()=>{l(!1,o,n)}))}var i=e+"logo.svg",d=e+"avatar.jpg",u=e+"editbtn.svg",m=e+"addbtn.svg",_=e+"editbtn-light.svg";document.querySelector(".header__logo").src=i,document.querySelector(".profile__avatar").src=d,document.querySelector(".profile__edit-button img").src=u,document.querySelector(".profile__add-button img").src=m,document.querySelector(".profile__pencilIcon").src=_;const v=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t={}){const r={headers:this._headers,...t},o=`${this._baseUrl}${e}`;return fetch(o,r).then(this._checkResponse)}getUserInfo(){return this._request("/users/me")}getInitialCards(){return this._request("/cards",{method:"GET"})}editUserInfo({name:e,about:t}){return this._request("/users/me",{method:"PATCH",body:JSON.stringify({name:e,about:t})})}updateAvatar({avatar:e}){return this._request("/users/me/avatar",{method:"PATCH",body:JSON.stringify({avatar:e})})}addCard({name:e,link:t}){return this._request("/cards",{method:"POST",body:JSON.stringify({name:e,link:t})})}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return this._request(`/cards/${e}/likes`,{method:"PUT"})}dislikeCard(e){return this._request(`/cards/${e}/likes`,{method:"DELETE"})}fetchInitialData(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f1f1dbab-8e17-48d3-a098-d77dfd6ea3c5","Content-Type":"application/json"}});let y;v.getUserInfo().then((e=>(y=e._id,f.textContent=e.name,S.textContent=e.about,D.src=e.avatar,v.getInitialCards()))).then((e=>{e.forEach((e=>{const t=H(e);R.append(t)}))})).catch(console.error);const h=document.querySelector(".profile__edit-button"),p=document.querySelector(".profile__add-button"),f=document.querySelector(".profile__name"),S=document.querySelector(".profile__description"),q=document.querySelectorAll(".modal__close-button"),b=document.querySelector("#delete-modal"),k=b.querySelector("#delete-form"),E=b.querySelector(".modal__cancel-button"),C=document.querySelector(".profile__avatar-button"),g=document.querySelector("#new-avatar-modal"),L=g.querySelector(".modal__form"),x=g.querySelector("#new-avatar-link-input"),D=document.querySelector(".profile__avatar"),A=document.querySelector("#edit-modal"),$=A.querySelector(".modal__form"),T=A.querySelector("#profile-name-input"),U=A.querySelector("#profile-description-input"),I=document.querySelector("#new-card-modal"),w=I.querySelector(".modal__form"),P=I.querySelector("#new-card-link-input"),B=I.querySelector("#new-card-caption-input"),O=document.querySelector("#preview-modal"),j=O.querySelector(".modal__image"),N=O.querySelector(".modal__caption"),J=document.querySelector("#card-template"),R=document.querySelector(".cards__list");function H(e){const t=J.content.querySelector(".card").cloneNode(!0);t._id=e._id;const r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__like-count"),c=t.querySelector(".card__delete-button");return r.textContent=e.name,o.src=e.link,o.alt=e.name,e.isLiked?(n.classList.add("card__like-button_liked"),a.textContent="1"):a.textContent="0",n.addEventListener("click",(()=>{(n.classList.contains("card__like-button_liked")?v.dislikeCard(e._id):v.likeCard(e._id)).then((e=>{n.classList.toggle("card__like-button_liked",e.isLiked),a.textContent=e.isLiked?"1":"0"})).catch((e=>{console.error("Error updating like status:",e)}))})),c.addEventListener("click",(()=>{K(b),k._cardToDelete=t})),o.addEventListener("click",(()=>{K(O),N.textContent=e.name,j.alt=e.name,j.src=e.link})),t}function K(e){function t(t){t.target.classList.contains("modal_opened")&&z(e)}function r(t){"Escape"===t.key&&z(e)}e.classList.add("modal_opened"),document.addEventListener("click",t),document.addEventListener("keydown",r),e._handleOverlayClick=t,e._handleEscapeKeyPress=r}function z(e){e.classList.remove("modal_opened"),document.removeEventListener("click",e._handleOverlayClick),document.removeEventListener("keydown",e._handleEscapeKeyPress)}function G(){const e=T.value,t=U.value;return v.editUserInfo({name:e,about:t}).then((e=>{f.textContent=e.name,S.textContent=e.about,z(A)}))}var M;q.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>z(t)))})),h.addEventListener("click",(()=>{T.value=f.textContent,U.value=S.textContent,c($,[T,U],t),K(A)})),C.addEventListener("click",(()=>{K(g)})),p.addEventListener("click",(()=>{K(I)})),E.addEventListener("click",(()=>{z(b)})),$.addEventListener("submit",(function(e){s(G,e,"Saving...")})),w.addEventListener("submit",(function(e){e.preventDefault();const t=w.querySelector(".modal__submit-button");l(!0,t),v.addCard({name:B.value,link:P.value}).then((t=>{const r=H(t);R.prepend(r),e.target.reset(),z(I)})).catch(console.error).finally((()=>{l(!1,t)}))})),k.addEventListener("submit",(e=>{e.preventDefault();const t=k.querySelector(".modal__submit-button");l(!0,t,"Delete","Deleting..."),v.removeCard(k._cardToDelete._id).then((()=>{s((()=>{k._cardToDelete.remove()})),z(b)})).catch(console.error).finally((()=>{l(!1,t,"Delete")}))})),L.addEventListener("submit",(e=>{e.preventDefault();const t=L.querySelector(".modal__submit-button");l(!0,t),v.updateAvatar({avatar:x.value}).then((t=>{D.src=t.avatar,e.target.reset(),z(g)})).catch(console.error).finally((()=>{l(!1,t)}))})),M=t,document.querySelectorAll(M.formSelector).forEach((e=>{const t=Array.from(e.querySelectorAll(M.inputSelector));((e,t)=>{const a=Array.from(e.querySelectorAll(t.inputSelector)),c=e.querySelector(t.submitButtonSelector);n(a,c,t),a.forEach((l=>{l.addEventListener("input",(()=>{((e,t,n)=>{t.validity.valid?o(e,t,n):((e,t,o,n)=>{const a=e.querySelector(`#${t.id}-error`);a?(a.textContent=o,a.setAttribute("role","alert"),t.classList.add(n.inputErrorClass)):r(`Error message element for input ${t.id} not found.`)})(e,t,t.validationMessage,n)})(e,l,t),n(a,c,t)}))}))})(e,M),e.addEventListener("reset",(()=>{c(e,t,M)}))}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQU9aLGdCQXRCaEJvSyxFQUFDMUosRUFBYUUsS0FDdEMsTUFBTVMsRUFBWTZJLE1BQU1DLEtBQ3RCekosRUFBWW9HLGlCQUFpQmxHLEVBQU9aLGdCQUVoQ3NCLEVBQWdCWixFQUFZSSxjQUFjRixFQUFPWCxzQkFFdkRtQixFQUFrQkMsRUFBV0MsRUFBZVYsR0FFNUNTLEVBQVVXLFNBQVNyQixJQUNqQkEsRUFBYWlJLGlCQUFpQixTQUFTLEtBdERoQnlCLEVBQUMzSixFQUFhQyxFQUFjQyxLQUNoREQsRUFBYWMsU0FBU0MsTUFRekJqQixFQUFlQyxFQUFhQyxFQUFjQyxHQXpDdkIwSixFQUFDNUosRUFBYUMsRUFBYzRKLEVBQWMzSixLQUMvRCxNQUFNQyxFQUFzQkgsRUFBWUksY0FDdEMsSUFBSUgsRUFBYUksWUFHZEYsR0FLTEEsRUFBb0JHLFlBQWN1SixFQUNsQzFKLEVBQW9CMkosYUFBYSxPQUFRLFNBQ3pDN0osRUFBYU8sVUFBVVksSUFBSWxCLEVBQU9ULGtCQU5oQ0UsRUFBUyxtQ0FBbUNNLEVBQWFJLGdCQU1ULEVBc0JoRHVKLENBQ0U1SixFQUNBQyxFQUNBQSxFQUFhOEosa0JBQ2I3SixFQUlKLEVBNkNJeUosQ0FBbUIzSixFQUFhQyxFQUFjQyxHQUM5Q1EsRUFBa0JDLEVBQVdDLEVBQWVWLEVBQU8sR0FDbkQsR0FDRixFQVdBd0osQ0FBa0IxSixFQUFhRSxHQUcvQkYsRUFBWWtJLGlCQUFpQixTQUFTLEtBQ3BDN0csRUFBZ0JyQixFQUFhVyxFQUFXVCxFQUFPLEdBQy9DLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9zZV9wcm9qZWN0X3Nwb3RzL1wiOyIsImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcbiAgZm9ybVNlbGVjdG9yOiBcIi5tb2RhbF9fZm9ybVwiLFxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX3N1Ym1pdC1idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXG59O1xuXG4vLyBVdGlsaXR5IGZvciBsb2dnaW5nIGVycm9yc1xuY29uc3QgbG9nRXJyb3IgPSAobWVzc2FnZSkgPT4ge1xuICBjb25zb2xlLmVycm9yKGBWYWxpZGF0aW9uIEVycm9yOiAke21lc3NhZ2V9YCk7XG59O1xuXG4vLyBTaG93IGlucHV0IGVycm9yIG1lc3NhZ2VcbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICApO1xuXG4gIGlmICghZXJyb3JNZXNzYWdlRWxlbWVudCkge1xuICAgIGxvZ0Vycm9yKGBFcnJvciBtZXNzYWdlIGVsZW1lbnQgZm9yIGlucHV0ICR7aW5wdXRFbGVtZW50LmlkfSBub3QgZm91bmQuYCk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgZXJyb3JNZXNzYWdlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwiYWxlcnRcIik7IC8vIEFjY2Vzc2liaWxpdHkgZW5oYW5jZW1lbnRcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XG59O1xuXG4vLyBIaWRlIGlucHV0IGVycm9yIG1lc3NhZ2VcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcbiAgKTtcblxuICBpZiAoIWVycm9yTWVzc2FnZUVsZW1lbnQpIHtcbiAgICBsb2dFcnJvcihgRXJyb3IgbWVzc2FnZSBlbGVtZW50IGZvciBpbnB1dCAke2lucHV0RWxlbWVudC5pZH0gbm90IGZvdW5kLmApO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xuICBlcnJvck1lc3NhZ2VFbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcInJvbGVcIik7XG4gIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbnB1dEVycm9yQ2xhc3MpO1xufTtcblxuLy8gQ2hlY2sgaW5wdXQgdmFsaWRpdHlcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICBzaG93SW5wdXRFcnJvcihcbiAgICAgIGZvcm1FbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LFxuICAgICAgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlLFxuICAgICAgY29uZmlnXG4gICAgKTtcbiAgfSBlbHNlIHtcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xuICB9XG59O1xuXG4vLyBDaGVjayBpZiBmb3JtIGhhcyBpbnZhbGlkIGlucHV0XG5jb25zdCBoYXNJbnZhbGlkSW5wdXQgPSAoaW5wdXRMaXN0KSA9PiB7XG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+ICFpbnB1dC52YWxpZGl0eS52YWxpZCk7XG59O1xuXG4vLyBUb2dnbGUgYnV0dG9uIHN0YXRlXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gIH1cbn07XG5cbi8vIERpc2FibGUgYnV0dG9uXG5jb25zdCBkaXNhYmxlQnV0dG9uID0gKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbn07XG5cbi8vIFJlc2V0IHZhbGlkYXRpb25cbmV4cG9ydCBjb25zdCByZXNldFZhbGlkYXRpb24gPSAoZm9ybUVsZW1lbnQsIGlucHV0TGlzdCwgY29uZmlnKSA9PiB7XG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCwgY29uZmlnKTtcbiAgfSk7XG5cbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcbiAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpOyAvLyBEaXNhYmxlIHRoZSBidXR0b24gZHVyaW5nIHJlc2V0XG59O1xuXG4vLyBBZGQgZXZlbnQgbGlzdGVuZXJzIHRvIHRoZSBmb3JtXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWxlbWVudCwgY29uZmlnKSA9PiB7XG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcilcbiAgKTtcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7IC8vIEluaXRpYWwgYnV0dG9uIHN0YXRlIGNoZWNrXG5cbiAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XG4gICAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7IC8vIFVwZGF0ZSBidXR0b24gc3RhdGUgb24gaW5wdXRcbiAgICB9KTtcbiAgfSk7XG59O1xuXG4vLyBFbmFibGUgdmFsaWRhdGlvbiBmb3IgYWxsIGZvcm1zXG5leHBvcnQgY29uc3QgZW5hYmxlVmFsaWRhdGlvbiA9IChjb25maWcpID0+IHtcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xuXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXG4gICAgKTtcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgY29uZmlnKTtcblxuICAgIC8vIENsZWFyIHZhbGlkYXRpb24gb24gZm9ybSByZXNldFxuICAgIGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNldFwiLCAoKSA9PiB7XG4gICAgICByZXNldFZhbGlkYXRpb24oZm9ybUVsZW1lbnQsIGlucHV0TGlzdCwgY29uZmlnKTtcbiAgICB9KTtcbiAgfSk7XG59O1xuIiwiZXhwb3J0IGZ1bmN0aW9uIHJlbmRlckxvYWRpbmcoXG4gIGlzTG9hZGluZyxcbiAgYnV0dG9uLFxuICBidXR0b25UZXh0ID0gXCJTYXZlXCIsXG4gIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIlxuKSB7XG4gIGlmIChpc0xvYWRpbmcpIHtcbiAgICBidXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgfSBlbHNlIHtcbiAgICBidXR0b24udGV4dENvbnRlbnQgPSBidXR0b25UZXh0O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYW5kbGVTdWJtaXQocmVxdWVzdCwgZXZ0LCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGV2dC5zdWJtaXR0ZXI7XG4gIGNvbnN0IGluaXRpYWxUZXh0ID0gc3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xuXG4gIHJlbmRlckxvYWRpbmcodHJ1ZSwgc3VibWl0QnV0dG9uLCBpbml0aWFsVGV4dCwgbG9hZGluZ1RleHQpO1xuXG4gIHJldHVybiByZXF1ZXN0KClcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBzdWJtaXRCdXR0b24sIGluaXRpYWxUZXh0KTtcbiAgICB9KTtcbn1cbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7IC8vIEltcG9ydGluZyB0aGUgQ1NTIGZpbGVcbmltcG9ydCB7XG4gIGVuYWJsZVZhbGlkYXRpb24sXG4gIHNldHRpbmdzLFxuICByZXNldFZhbGlkYXRpb24sXG59IGZyb20gXCIuLi9zY3JpcHRzL3ZhbGlkYXRpb24uanNcIjsgLy8gSW1wb3J0aW5nIHZhbGlkYXRpb24gZnVuY3Rpb25zXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjsgLy8gSW1wb3J0aW5nIHRoZSBBUEkgY2xhc3NcbmltcG9ydCB7IGhhbmRsZVN1Ym1pdCwgcmVuZGVyTG9hZGluZyB9IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiOyAvLyBJbXBvcnRpbmcgdXRpbGl0eSBmdW5jdGlvbnNcblxuLy8gSW1wb3J0aW5nIGltYWdlcyBhbmQgb3RoZXIgYXNzZXRzXG5pbXBvcnQgbG9nb1BhdGggZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiO1xuaW1wb3J0IGF2YXRhclBhdGggZnJvbSBcIi4uL2ltYWdlcy9hdmF0YXIuanBnXCI7XG5pbXBvcnQgZWRpdEJ1dHRvblBhdGggZnJvbSBcIi4uL2ltYWdlcy9lZGl0YnRuLnN2Z1wiO1xuaW1wb3J0IGFkZEJ1dHRvblBhdGggZnJvbSBcIi4uL2ltYWdlcy9hZGRidG4uc3ZnXCI7XG5pbXBvcnQgZWRpdExpZ2h0QnV0dG9uUGF0aCBmcm9tIFwiLi4vaW1hZ2VzL2VkaXRidG4tbGlnaHQuc3ZnXCI7XG5cbi8vIEVuc3VyZSBzbWFsbHRhYmxldHZpZXcucG5nIGlzIGNvcGllZCB0byBkaXN0XG5pbXBvcnQgXCIuL19jb3B5X3NtYWxsdGFibGV0dmlldy5qc1wiO1xuXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmhlYWRlcl9fbG9nb1wiKS5zcmMgPSBsb2dvUGF0aDtcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpLnNyYyA9IGF2YXRhclBhdGg7XG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uIGltZ1wiKS5zcmMgPSBlZGl0QnV0dG9uUGF0aDtcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvbiBpbWdcIikuc3JjID0gYWRkQnV0dG9uUGF0aDtcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcGVuY2lsSWNvblwiKS5zcmMgPSBlZGl0TGlnaHRCdXR0b25QYXRoO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJmMWYxZGJhYi04ZTE3LTQ4ZDMtYTA5OC1kNzdkZmQ2ZWEzYzVcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5sZXQgdXNlcklkO1xuXG5hcGlcbiAgLmdldFVzZXJJbmZvKClcbiAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gICAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcbiAgICBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQgPSB1c2VyRGF0YS5hYm91dDtcbiAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcbiAgICByZXR1cm4gYXBpLmdldEluaXRpYWxDYXJkcygpO1xuICB9KVxuICAudGhlbigoY2FyZHMpID0+IHtcbiAgICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGNhcmQpO1xuICAgICAgY2FyZHNMaXN0LmFwcGVuZChjYXJkRWxlbWVudCk7XG4gICAgfSk7XG4gIH0pXG4gIC5jYXRjaChjb25zb2xlLmVycm9yKTtcblxuLy8gUHJvZmlsZSBTZWxlY3RvcnNcbmNvbnN0IGVkaXRNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XG5jb25zdCBjYXJkTW9kYWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5cbi8vIE1vZGFsIFNlbGVjdG9yc1xuLy8gY29uc3QgbW9kYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbFwiKTtcbmNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcbmNvbnN0IGRlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtbW9kYWxcIik7XG5jb25zdCBkZWxldGVGb3JtID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtZm9ybVwiKTtcbmNvbnN0IGNhbmNlbERlbGV0ZUJ1dHRvbiA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhbmNlbC1idXR0b25cIik7XG5jb25zdCBhdmF0YXJFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItYnV0dG9uXCIpO1xuY29uc3QgYXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25ldy1hdmF0YXItbW9kYWxcIik7XG5jb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGF2YXRhckxpbmtJbnB1dCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LWF2YXRhci1saW5rLWlucHV0XCIpO1xuY29uc3QgcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xuXG4vLyBNb2RhbCAtIEVkaXQgUHJvZmlsZVxuY29uc3QgZWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsXCIpO1xuY29uc3QgZWRpdEZvcm0gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGVkaXRNb2RhbE5hbWVJbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcbmNvbnN0IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQgPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuXG4vLyBNb2RhbCAtIEFkZCBDYXJkXG5jb25zdCBjYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI25ldy1jYXJkLW1vZGFsXCIpO1xuY29uc3QgY2FyZEZvcm0gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbi8vIGNvbnN0IGNhcmRTdWJtaXRCdXR0b24gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNuZXctY2FyZC1saW5rLWlucHV0XCIpO1xuY29uc3QgY2FyZENhcHRpb25JbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI25ldy1jYXJkLWNhcHRpb24taW5wdXRcIik7XG5cbi8vIE1vZGFsIFByZXZpZXdcbmNvbnN0IHByZXZpZXdNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJldmlldy1tb2RhbFwiKTtcbmNvbnN0IHByZXZpZXdJbWFnZSA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbmNvbnN0IHByZXZpZXdDYXB0aW9uID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhcHRpb25cIik7XG5cbi8vIENhcmRzXG5jb25zdCBjYXJkVGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIik7XG5jb25zdCBjYXJkc0xpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRzX19saXN0XCIpO1xuXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XG4gIGNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgY2FyZEVsZW1lbnQuX2lkID0gZGF0YS5faWQ7XG5cbiAgY29uc3QgY2FyZFRpdGxlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgY29uc3QgY2FyZEltYWdlID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgY29uc3QgY2FyZExpa2VCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICBjb25zdCBjYXJkTGlrZUNvdW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWNvdW50XCIpO1xuICBjb25zdCBjYXJkRGVsZXRlQnV0dG9uID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xuXG4gIC8vIFNldCBjYXJkIGRhdGFcbiAgY2FyZFRpdGxlLnRleHRDb250ZW50ID0gZGF0YS5uYW1lO1xuICBjYXJkSW1hZ2Uuc3JjID0gZGF0YS5saW5rOyAvLyBNYWtlIHN1cmUgdGhpcyBsaW5lIGlzIHByZXNlbnRcbiAgY2FyZEltYWdlLmFsdCA9IGRhdGEubmFtZTtcblxuICAvLyBTZXQgaW5pdGlhbCBsaWtlIHN0YXRlIGFuZCBjb3VudFxuICBpZiAoZGF0YS5pc0xpa2VkKSB7XG4gICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIpO1xuICAgIGNhcmRMaWtlQ291bnQudGV4dENvbnRlbnQgPSBcIjFcIjsgLy8gU2V0IHRvIDEgaWYgdGhlIGNhcmQgaXMgbGlrZWRcbiAgfSBlbHNlIHtcbiAgICBjYXJkTGlrZUNvdW50LnRleHRDb250ZW50ID0gXCIwXCI7IC8vIFNldCB0byAwIGlmIHRoZSBjYXJkIGlzIG5vdCBsaWtlZFxuICB9XG5cbiAgY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBjb25zdCBpc0N1cnJlbnRseUxpa2VkID0gY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFxuICAgICAgXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiXG4gICAgKTtcblxuICAgIGNvbnN0IGxpa2VDYXJkUHJvbWlzZSA9IGlzQ3VycmVudGx5TGlrZWRcbiAgICAgID8gYXBpLmRpc2xpa2VDYXJkKGRhdGEuX2lkKVxuICAgICAgOiBhcGkubGlrZUNhcmQoZGF0YS5faWQpO1xuXG4gICAgbGlrZUNhcmRQcm9taXNlXG4gICAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcbiAgICAgICAgY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcbiAgICAgICAgICBcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCIsXG4gICAgICAgICAgdXBkYXRlZENhcmQuaXNMaWtlZFxuICAgICAgICApO1xuICAgICAgICBjYXJkTGlrZUNvdW50LnRleHRDb250ZW50ID0gdXBkYXRlZENhcmQuaXNMaWtlZCA/IFwiMVwiIDogXCIwXCI7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgbGlrZSBzdGF0dXM6XCIsIGVycm9yKTtcbiAgICAgIH0pO1xuICB9KTtcblxuICAvLyBkZWxldGUgYW5kIHByZXZpZXcgZXZlbnQgbGlzdGVuZXJzXG4gIGNhcmREZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBvcGVuTW9kYWwoZGVsZXRlTW9kYWwpO1xuICAgIGRlbGV0ZUZvcm0uX2NhcmRUb0RlbGV0ZSA9IGNhcmRFbGVtZW50O1xuICB9KTtcblxuICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcbiAgICBwcmV2aWV3Q2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBwcmV2aWV3SW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuICAgIHByZXZpZXdJbWFnZS5zcmMgPSBkYXRhLmxpbms7XG4gIH0pO1xuXG4gIHJldHVybiBjYXJkRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XG4gIG1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG5cbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGhhbmRsZU92ZXJsYXlDbGljayk7XG4gIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGhhbmRsZUVzY2FwZUtleVByZXNzKTtcblxuICBtb2RhbC5faGFuZGxlT3ZlcmxheUNsaWNrID0gaGFuZGxlT3ZlcmxheUNsaWNrO1xuICBtb2RhbC5faGFuZGxlRXNjYXBlS2V5UHJlc3MgPSBoYW5kbGVFc2NhcGVLZXlQcmVzcztcblxuICBmdW5jdGlvbiBoYW5kbGVPdmVybGF5Q2xpY2soZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX29wZW5lZFwiKSkge1xuICAgICAgY2xvc2VNb2RhbChtb2RhbCk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gaGFuZGxlRXNjYXBlS2V5UHJlc3MoZXZlbnQpIHtcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICBjbG9zZU1vZGFsKG1vZGFsKTtcbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gY2xvc2VNb2RhbChtb2RhbCkge1xuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuXG4gIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBtb2RhbC5faGFuZGxlT3ZlcmxheUNsaWNrKTtcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgbW9kYWwuX2hhbmRsZUVzY2FwZUtleVByZXNzKTtcbn1cblxuLy8gZnVuY3Rpb24gcmVuZGVyTG9hZGluZyhcbi8vIGlzTG9hZGluZyxcbi8vIGJ1dHRvbixcbi8vIGJ1dHRvblRleHQgPSBcIlNhdmVcIixcbi8vIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIlxuLy8gKSB7XG4vLyBidXR0b24udGV4dENvbnRlbnQgPSBpc0xvYWRpbmcgPyBsb2FkaW5nVGV4dCA6IGJ1dHRvblRleHQ7XG4vLyB9XG5cbi8vIFVuaXZlcnNhbCBDbG9zZSBCdXR0b24gSGFuZGxlclxuY2xvc2VCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xuICBjb25zdCBtb2RhbCA9IGJ1dHRvbi5jbG9zZXN0KFwiLm1vZGFsXCIpO1xuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwobW9kYWwpKTtcbn0pO1xuXG4vLyBIYW5kbGVyc1xuZnVuY3Rpb24gbWFrZUVkaXRQcm9maWxlUmVxdWVzdCgpIHtcbiAgLy8gR2V0IGZvcm0gdmFsdWVzXG4gIGNvbnN0IG5hbWUgPSBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWU7XG4gIGNvbnN0IGFib3V0ID0gZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZTtcblxuICAvLyBNYWtlIEFQSSBjYWxsIHRvIGVkaXQgdXNlciBpbmZvXG4gIHJldHVybiBhcGkuZWRpdFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkudGhlbigodXNlckRhdGEpID0+IHtcbiAgICAvLyBVcGRhdGUgdGhlIERPTSB3aXRoIHRoZSBuZXcgdXNlciBkYXRhXG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xuICAgIC8vIENsb3NlIHRoZSBtb2RhbFxuICAgIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUVkaXRGb3JtU3VibWl0KGV2dCkge1xuICBoYW5kbGVTdWJtaXQobWFrZUVkaXRQcm9maWxlUmVxdWVzdCwgZXZ0LCBcIlNhdmluZy4uLlwiKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQ2FyZEZvcm1TdWJtaXQoZXZ0KSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBzdWJtaXRCdXR0b24gPSBjYXJkRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpO1xuICByZW5kZXJMb2FkaW5nKHRydWUsIHN1Ym1pdEJ1dHRvbik7XG5cbiAgYXBpXG4gICAgLmFkZENhcmQoe1xuICAgICAgbmFtZTogY2FyZENhcHRpb25JbnB1dC52YWx1ZSxcbiAgICAgIGxpbms6IGNhcmRMaW5rSW5wdXQudmFsdWUsXG4gICAgfSlcbiAgICAudGhlbigoY2FyZERhdGEpID0+IHtcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZERhdGEpO1xuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsZW1lbnQpO1xuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xuICAgICAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgc3VibWl0QnV0dG9uKTtcbiAgICB9KTtcbn1cblxuLy8gRWRpdCBNb2RhbCBMaXN0ZW5lcnNcbmVkaXRNb2RhbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZS50ZXh0Q29udGVudDtcbiAgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcbiAgcmVzZXRWYWxpZGF0aW9uKFxuICAgIGVkaXRGb3JtLFxuICAgIFtlZGl0TW9kYWxOYW1lSW5wdXQsIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXRdLFxuICAgIHNldHRpbmdzXG4gICk7XG4gIG9wZW5Nb2RhbChlZGl0TW9kYWwpO1xufSk7XG5cbi8vIEF2YXRhciBNb2RhbCBMaXN0ZW5lclxuYXZhdGFyRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBvcGVuTW9kYWwoYXZhdGFyTW9kYWwpO1xufSk7XG5cbi8vIENhcmQgTW9kYWwgTGlzdGVuZXJzXG5jYXJkTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgb3Blbk1vZGFsKGNhcmRNb2RhbCk7XG59KTtcblxuY2FuY2VsRGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xufSk7XG5cbi8vIEZvcm0gTGlzdGVuZXJzXG5lZGl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRGb3JtU3VibWl0KTtcbmNhcmRGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgaGFuZGxlQ2FyZEZvcm1TdWJtaXQpO1xuXG5kZWxldGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZGVsZXRlRm9ybS5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIpO1xuICByZW5kZXJMb2FkaW5nKHRydWUsIHN1Ym1pdEJ1dHRvbiwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcblxuICBhcGlcbiAgICAucmVtb3ZlQ2FyZChkZWxldGVGb3JtLl9jYXJkVG9EZWxldGUuX2lkKSAvLyBDaGFuZ2VkIGZyb20gZGVsZXRlQ2FyZCB0byByZW1vdmVDYXJkXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgaGFuZGxlU3VibWl0KCgpID0+IHtcbiAgICAgICAgZGVsZXRlRm9ybS5fY2FyZFRvRGVsZXRlLnJlbW92ZSgpO1xuICAgICAgfSk7XG4gICAgICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcbiAgICB9KVxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIHN1Ym1pdEJ1dHRvbiwgXCJEZWxldGVcIik7XG4gICAgfSk7XG59KTtcblxuLy8gQXZhdGFyIEZvcm0gU3VibWl0IEhhbmRsZXJcbmF2YXRhckZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBzdWJtaXRCdXR0b24gPSBhdmF0YXJGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIik7XG4gIHJlbmRlckxvYWRpbmcodHJ1ZSwgc3VibWl0QnV0dG9uKTtcblxuICBhcGlcbiAgICAudXBkYXRlQXZhdGFyKHtcbiAgICAgIGF2YXRhcjogYXZhdGFyTGlua0lucHV0LnZhbHVlLFxuICAgIH0pXG4gICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XG4gICAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcbiAgICAgIGV2dC50YXJnZXQucmVzZXQoKTtcbiAgICAgIGNsb3NlTW9kYWwoYXZhdGFyTW9kYWwpO1xuICAgIH0pXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgc3VibWl0QnV0dG9uKTtcbiAgICB9KTtcbn0pO1xuXG5lbmFibGVWYWxpZGF0aW9uKHNldHRpbmdzKTtcbiIsImNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgX3JlcXVlc3QoZW5kcG9pbnQsIG9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IGZpbmFsT3B0aW9ucyA9IHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICAuLi5vcHRpb25zLFxuICAgIH07XG4gICAgY29uc3QgdXJsID0gYCR7dGhpcy5fYmFzZVVybH0ke2VuZHBvaW50fWA7XG4gICAgcmV0dXJuIGZldGNoKHVybCwgZmluYWxPcHRpb25zKS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWVcIik7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvY2FyZHNcIiwge1xuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gUEFUQ0ggL3VzZXJzL21lXG4gIGVkaXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi91c2Vycy9tZVwiLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgYWJvdXQgfSksXG4gICAgfSk7XG4gIH1cblxuICAvLyBQQVRDSCAvdXNlcnMvbWUvYXZhdGFyXG4gIHVwZGF0ZUF2YXRhcih7IGF2YXRhciB9KSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWUvYXZhdGFyXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBhdmF0YXIgfSksXG4gICAgfSk7XG4gIH1cblxuICAvLyBQT1NUIC9jYXJkc1xuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvY2FyZHNcIiwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIERFTEVURSAvY2FyZHMvOmNhcmRJZFxuICByZW1vdmVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICAvLyBQVVQgL2NhcmRzLzpjYXJkSWQvbGlrZXNcbiAgbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgfSk7XG4gIH1cblxuICAvLyBERUxFVEUgL2NhcmRzLzpjYXJkSWQvbGlrZXNcbiAgZGlzbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgfSk7XG4gIH1cblxuICAvLyBIZWxwZXI6IEZldGNoIGluaXRpYWwgZGF0YSBzaW11bHRhbmVvdXNseSAodXNlciBpbmZvICYgY2FyZHMpXG4gIGZldGNoSW5pdGlhbERhdGEoKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldFVzZXJJbmZvKCksIHRoaXMuZ2V0SW5pdGlhbENhcmRzKCldKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBBcGk7XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJsb2dFcnJvciIsIm1lc3NhZ2UiLCJjb25zb2xlIiwiZXJyb3IiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwicmVtb3ZlQXR0cmlidXRlIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50Iiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImFkZCIsInJlc2V0VmFsaWRhdGlvbiIsImZvckVhY2giLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiYnV0dG9uIiwiYnV0dG9uVGV4dCIsImxvYWRpbmdUZXh0IiwiaGFuZGxlU3VibWl0IiwicmVxdWVzdCIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwic3VibWl0QnV0dG9uIiwic3VibWl0dGVyIiwiaW5pdGlhbFRleHQiLCJjYXRjaCIsImZpbmFsbHkiLCJkb2N1bWVudCIsInNyYyIsImxvZ29QYXRoIiwiYXZhdGFyUGF0aCIsImVkaXRCdXR0b25QYXRoIiwiYWRkQnV0dG9uUGF0aCIsImVkaXRMaWdodEJ1dHRvblBhdGgiLCJhcGkiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJlbmRwb2ludCIsImZpbmFsT3B0aW9ucyIsInVybCIsImZldGNoIiwidGhlbiIsImdldFVzZXJJbmZvIiwiZ2V0SW5pdGlhbENhcmRzIiwibWV0aG9kIiwiZWRpdFVzZXJJbmZvIiwibmFtZSIsImFib3V0IiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXIiLCJhZGRDYXJkIiwibGluayIsInJlbW92ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsImRpc2xpa2VDYXJkIiwiZmV0Y2hJbml0aWFsRGF0YSIsImFsbCIsImF1dGhvcml6YXRpb24iLCJ1c2VySWQiLCJ1c2VyRGF0YSIsIl9pZCIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUF2YXRhciIsImNhcmRzIiwiY2FyZCIsImNhcmRFbGVtZW50IiwiZ2V0Q2FyZEVsZW1lbnQiLCJjYXJkc0xpc3QiLCJhcHBlbmQiLCJlZGl0TW9kYWxCdXR0b24iLCJjYXJkTW9kYWxCdXR0b24iLCJjbG9zZUJ1dHRvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZGVsZXRlTW9kYWwiLCJkZWxldGVGb3JtIiwiY2FuY2VsRGVsZXRlQnV0dG9uIiwiYXZhdGFyRWRpdEJ1dHRvbiIsImF2YXRhck1vZGFsIiwiYXZhdGFyRm9ybSIsImF2YXRhckxpbmtJbnB1dCIsImVkaXRNb2RhbCIsImVkaXRGb3JtIiwiZWRpdE1vZGFsTmFtZUlucHV0IiwiZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dCIsImNhcmRNb2RhbCIsImNhcmRGb3JtIiwiY2FyZExpbmtJbnB1dCIsImNhcmRDYXB0aW9uSW5wdXQiLCJwcmV2aWV3TW9kYWwiLCJwcmV2aWV3SW1hZ2UiLCJwcmV2aWV3Q2FwdGlvbiIsImNhcmRUZW1wbGF0ZSIsImRhdGEiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZFRpdGxlIiwiY2FyZEltYWdlIiwiY2FyZExpa2VCdXR0b24iLCJjYXJkTGlrZUNvdW50IiwiY2FyZERlbGV0ZUJ1dHRvbiIsImFsdCIsImlzTGlrZWQiLCJhZGRFdmVudExpc3RlbmVyIiwiY29udGFpbnMiLCJ1cGRhdGVkQ2FyZCIsInRvZ2dsZSIsIm9wZW5Nb2RhbCIsIl9jYXJkVG9EZWxldGUiLCJtb2RhbCIsImhhbmRsZU92ZXJsYXlDbGljayIsImV2ZW50IiwidGFyZ2V0IiwiY2xvc2VNb2RhbCIsImhhbmRsZUVzY2FwZUtleVByZXNzIiwia2V5IiwiX2hhbmRsZU92ZXJsYXlDbGljayIsIl9oYW5kbGVFc2NhcGVLZXlQcmVzcyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJtYWtlRWRpdFByb2ZpbGVSZXF1ZXN0IiwidmFsdWUiLCJjbG9zZXN0IiwiY2FyZERhdGEiLCJwcmVwZW5kIiwicmVzZXQiLCJBcnJheSIsImZyb20iLCJzZXRFdmVudExpc3RlbmVycyIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlIiwic2V0QXR0cmlidXRlIiwidmFsaWRhdGlvbk1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9