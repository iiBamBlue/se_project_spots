!function(){"use strict";var e="/se_project_spots/";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=e=>{console.error(`Validation Error: ${e}`)},o=(e,t,o)=>{const n=e.querySelector(`#${t.id}-error`);n?(n.textContent="",n.removeAttribute("role"),t.classList.remove(o.inputErrorClass)):r(`Error message element for input ${t.id} not found.`)},n=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?a(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},a=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},l=(e,t,r)=>{t.forEach((t=>{o(e,t,r)}));const n=e.querySelector(r.submitButtonSelector);a(n,r)};function c(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";t.textContent=e?o:r}function s(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Saving...";t.preventDefault();const o=t.submitter,n=o.textContent;return c(!0,o,n,r),e().catch(console.error).finally((()=>{c(!1,o,n)}))}var i=e+"5e2464bff616faf70484.svg",d=e+"2fc47fd8e9a9bcd9612f.jpg",u=e+"49e44e5e03758262e8bf.svg",m=e+"975792ea68af0a3c209d.svg",_=e+"c81b22e9874268723f8d.svg";document.querySelector(".header__logo").src=i,document.querySelector(".profile__avatar").src=d,document.querySelector(".profile__edit-button img").src=u,document.querySelector(".profile__add-button img").src=m,document.querySelector(".profile__pencilIcon").src=_;const v=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r={headers:this._headers,...t},o=`${this._baseUrl}${e}`;return fetch(o,r).then(this._checkResponse)}getUserInfo(){return this._request("/users/me")}getInitialCards(){return this._request("/cards",{method:"GET"})}editUserInfo(e){let{name:t,about:r}=e;return this._request("/users/me",{method:"PATCH",body:JSON.stringify({name:t,about:r})})}updateAvatar(e){let{avatar:t}=e;return this._request("/users/me/avatar",{method:"PATCH",body:JSON.stringify({avatar:t})})}addCard(e){let{name:t,link:r}=e;return this._request("/cards",{method:"POST",body:JSON.stringify({name:t,link:r})})}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return this._request(`/cards/${e}/likes`,{method:"PUT"})}dislikeCard(e){return this._request(`/cards/${e}/likes`,{method:"DELETE"})}fetchInitialData(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f1f1dbab-8e17-48d3-a098-d77dfd6ea3c5","Content-Type":"application/json"}});let f;v.getUserInfo().then((e=>(f=e._id,p.textContent=e.name,S.textContent=e.about,D.src=e.avatar,v.getInitialCards()))).then((e=>{e.forEach((e=>{const t=H(e);R.append(t)}))})).catch(console.error);const y=document.querySelector(".profile__edit-button"),h=document.querySelector(".profile__add-button"),p=document.querySelector(".profile__name"),S=document.querySelector(".profile__description"),q=document.querySelectorAll(".modal__close-button"),b=document.querySelector("#delete-modal"),k=b.querySelector("#delete-form"),E=b.querySelector(".modal__cancel-button"),C=document.querySelector(".profile__avatar-button"),g=document.querySelector("#new-avatar-modal"),L=g.querySelector(".modal__form"),x=g.querySelector("#new-avatar-link-input"),D=document.querySelector(".profile__avatar"),A=document.querySelector("#edit-modal"),$=A.querySelector(".modal__form"),T=A.querySelector("#profile-name-input"),U=A.querySelector("#profile-description-input"),I=document.querySelector("#new-card-modal"),w=I.querySelector(".modal__form"),P=I.querySelector("#new-card-link-input"),B=I.querySelector("#new-card-caption-input"),O=document.querySelector("#preview-modal"),j=O.querySelector(".modal__image"),N=O.querySelector(".modal__caption"),J=document.querySelector("#card-template"),R=document.querySelector(".cards__list");function H(e){const t=J.content.querySelector(".card").cloneNode(!0);t._id=e._id;const r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__like-count"),l=t.querySelector(".card__delete-button");return r.textContent=e.name,o.src=e.link,o.alt=e.name,e.isLiked?(n.classList.add("card__like-button_liked"),a.textContent="1"):a.textContent="0",n.addEventListener("click",(()=>{(n.classList.contains("card__like-button_liked")?v.dislikeCard(e._id):v.likeCard(e._id)).then((e=>{n.classList.toggle("card__like-button_liked",e.isLiked),a.textContent=e.isLiked?"1":"0"})).catch((e=>{console.error("Error updating like status:",e)}))})),l.addEventListener("click",(()=>{K(b),k._cardToDelete=t})),o.addEventListener("click",(()=>{K(O),N.textContent=e.name,j.alt=e.name,j.src=e.link})),t}function K(e){function t(t){t.target.classList.contains("modal_opened")&&z(e)}function r(t){"Escape"===t.key&&z(e)}e.classList.add("modal_opened"),document.addEventListener("click",t),document.addEventListener("keydown",r),e._handleOverlayClick=t,e._handleEscapeKeyPress=r}function z(e){e.classList.remove("modal_opened"),document.removeEventListener("click",e._handleOverlayClick),document.removeEventListener("keydown",e._handleEscapeKeyPress)}function G(){const e=T.value,t=U.value;return v.editUserInfo({name:e,about:t}).then((e=>{p.textContent=e.name,S.textContent=e.about,z(A)}))}var M;q.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>z(t)))})),y.addEventListener("click",(()=>{T.value=p.textContent,U.value=S.textContent,l($,[T,U],t),K(A)})),C.addEventListener("click",(()=>{K(g)})),h.addEventListener("click",(()=>{K(I)})),E.addEventListener("click",(()=>{z(b)})),$.addEventListener("submit",(function(e){s(G,e,"Saving...")})),w.addEventListener("submit",(function(e){e.preventDefault();const t=w.querySelector(".modal__submit-button");c(!0,t),v.addCard({name:B.value,link:P.value}).then((t=>{const r=H(t);R.prepend(r),e.target.reset(),z(I)})).catch(console.error).finally((()=>{c(!1,t)}))})),k.addEventListener("submit",(e=>{e.preventDefault();const t=k.querySelector(".modal__submit-button");c(!0,t,"Delete","Deleting..."),v.removeCard(k._cardToDelete._id).then((()=>{s((()=>{k._cardToDelete.remove()})),z(b)})).catch(console.error).finally((()=>{c(!1,t,"Delete")}))})),L.addEventListener("submit",(e=>{e.preventDefault();const t=L.querySelector(".modal__submit-button");c(!0,t),v.updateAvatar({avatar:x.value}).then((t=>{D.src=t.avatar,e.target.reset(),z(g)})).catch(console.error).finally((()=>{c(!1,t)}))})),M=t,document.querySelectorAll(M.formSelector).forEach((e=>{const t=Array.from(e.querySelectorAll(M.inputSelector));((e,t)=>{const a=Array.from(e.querySelectorAll(t.inputSelector)),l=e.querySelector(t.submitButtonSelector);n(a,l,t),a.forEach((c=>{c.addEventListener("input",(()=>{((e,t,n)=>{t.validity.valid?o(e,t,n):((e,t,o,n)=>{const a=e.querySelector(`#${t.id}-error`);a?(a.textContent=o,a.setAttribute("role","alert"),t.classList.add(n.inputErrorClass)):r(`Error message element for input ${t.id} not found.`)})(e,t,t.validationMessage,n)})(e,c,t),n(a,l,t)}))}))})(e,M),e.addEventListener("reset",(()=>{l(e,t,M)}))}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFnQnJCLEVBQWFXLEVBQVdULEVBQU8sR0FDL0MsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3NjcmlwdHMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3V0aWxzL3V0aWxzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiL3NlX3Byb2plY3Rfc3BvdHMvXCI7IiwiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnV0dG9uX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JcIixcclxufTtcclxuXHJcbi8vIFV0aWxpdHkgZm9yIGxvZ2dpbmcgZXJyb3JzXHJcbmNvbnN0IGxvZ0Vycm9yID0gKG1lc3NhZ2UpID0+IHtcclxuICBjb25zb2xlLmVycm9yKGBWYWxpZGF0aW9uIEVycm9yOiAke21lc3NhZ2V9YCk7XHJcbn07XHJcblxyXG4vLyBTaG93IGlucHV0IGVycm9yIG1lc3NhZ2VcclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlLCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICk7XHJcblxyXG4gIGlmICghZXJyb3JNZXNzYWdlRWxlbWVudCkge1xyXG4gICAgbG9nRXJyb3IoYEVycm9yIG1lc3NhZ2UgZWxlbWVudCBmb3IgaW5wdXQgJHtpbnB1dEVsZW1lbnQuaWR9IG5vdCBmb3VuZC5gKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgZXJyb3JNZXNzYWdlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJyb2xlXCIsIFwiYWxlcnRcIik7IC8vIEFjY2Vzc2liaWxpdHkgZW5oYW5jZW1lbnRcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZChjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbi8vIEhpZGUgaW5wdXQgZXJyb3IgbWVzc2FnZVxyXG5jb25zdCBoaWRlSW5wdXRFcnJvciA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcclxuICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICk7XHJcblxyXG4gIGlmICghZXJyb3JNZXNzYWdlRWxlbWVudCkge1xyXG4gICAgbG9nRXJyb3IoYEVycm9yIG1lc3NhZ2UgZWxlbWVudCBmb3IgaW5wdXQgJHtpbnB1dEVsZW1lbnQuaWR9IG5vdCBmb3VuZC5gKTtcclxuICAgIHJldHVybjtcclxuICB9XHJcblxyXG4gIGVycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIGVycm9yTWVzc2FnZUVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwicm9sZVwiKTtcclxuICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuXHJcbi8vIENoZWNrIGlucHV0IHZhbGlkaXR5XHJcbmNvbnN0IGNoZWNrSW5wdXRWYWxpZGl0eSA9IChmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpID0+IHtcclxuICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgc2hvd0lucHV0RXJyb3IoXHJcbiAgICAgIGZvcm1FbGVtZW50LFxyXG4gICAgICBpbnB1dEVsZW1lbnQsXHJcbiAgICAgIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSxcclxuICAgICAgY29uZmlnXHJcbiAgICApO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50LCBjb25maWcpO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIENoZWNrIGlmIGZvcm0gaGFzIGludmFsaWQgaW5wdXRcclxuY29uc3QgaGFzSW52YWxpZElucHV0ID0gKGlucHV0TGlzdCkgPT4ge1xyXG4gIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXQpID0+ICFpbnB1dC52YWxpZGl0eS52YWxpZCk7XHJcbn07XHJcblxyXG4vLyBUb2dnbGUgYnV0dG9uIHN0YXRlXHJcbmNvbnN0IHRvZ2dsZUJ1dHRvblN0YXRlID0gKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKGhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XHJcbiAgICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgfVxyXG59O1xyXG5cclxuLy8gRGlzYWJsZSBidXR0b25cclxuY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b25FbGVtZW50LCBjb25maWcpID0+IHtcclxuICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG59O1xyXG5cclxuLy8gUmVzZXQgdmFsaWRhdGlvblxyXG5leHBvcnQgY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbGVtZW50LCBpbnB1dExpc3QsIGNvbmZpZykgPT4ge1xyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0LCBjb25maWcpO1xyXG4gIH0pO1xyXG5cclxuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIGRpc2FibGVCdXR0b24oYnV0dG9uRWxlbWVudCwgY29uZmlnKTsgLy8gRGlzYWJsZSB0aGUgYnV0dG9uIGR1cmluZyByZXNldFxyXG59O1xyXG5cclxuLy8gQWRkIGV2ZW50IGxpc3RlbmVycyB0byB0aGUgZm9ybVxyXG5jb25zdCBzZXRFdmVudExpc3RlbmVycyA9IChmb3JtRWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXHJcbiAgKTtcclxuICBjb25zdCBidXR0b25FbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7IC8vIEluaXRpYWwgYnV0dG9uIHN0YXRlIGNoZWNrXHJcblxyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcclxuICAgICAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpOyAvLyBVcGRhdGUgYnV0dG9uIHN0YXRlIG9uIGlucHV0XHJcbiAgICB9KTtcclxuICB9KTtcclxufTtcclxuXHJcbi8vIEVuYWJsZSB2YWxpZGF0aW9uIGZvciBhbGwgZm9ybXNcclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xyXG5cclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCwgY29uZmlnKTtcclxuXHJcbiAgICAvLyBDbGVhciB2YWxpZGF0aW9uIG9uIGZvcm0gcmVzZXRcclxuICAgIGZvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJyZXNldFwiLCAoKSA9PiB7XHJcbiAgICAgIHJlc2V0VmFsaWRhdGlvbihmb3JtRWxlbWVudCwgaW5wdXRMaXN0LCBjb25maWcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcbiIsImV4cG9ydCBmdW5jdGlvbiByZW5kZXJMb2FkaW5nKFxuICBpc0xvYWRpbmcsXG4gIGJ1dHRvbixcbiAgYnV0dG9uVGV4dCA9IFwiU2F2ZVwiLFxuICBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCJcbikge1xuICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgYnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gIH0gZWxzZSB7XG4gICAgYnV0dG9uLnRleHRDb250ZW50ID0gYnV0dG9uVGV4dDtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlU3VibWl0KHJlcXVlc3QsIGV2dCwgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCBzdWJtaXRCdXR0b24gPSBldnQuc3VibWl0dGVyO1xuICBjb25zdCBpbml0aWFsVGV4dCA9IHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcblxuICByZW5kZXJMb2FkaW5nKHRydWUsIHN1Ym1pdEJ1dHRvbiwgaW5pdGlhbFRleHQsIGxvYWRpbmdUZXh0KTtcblxuICByZXR1cm4gcmVxdWVzdCgpXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgc3VibWl0QnV0dG9uLCBpbml0aWFsVGV4dCk7XG4gICAgfSk7XG59XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiOyAvLyBJbXBvcnRpbmcgdGhlIENTUyBmaWxlXHJcbmltcG9ydCB7XHJcbiAgZW5hYmxlVmFsaWRhdGlvbixcclxuICBzZXR0aW5ncyxcclxuICByZXNldFZhbGlkYXRpb24sXHJcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiOyAvLyBJbXBvcnRpbmcgdmFsaWRhdGlvbiBmdW5jdGlvbnNcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vdXRpbHMvQXBpLmpzXCI7IC8vIEltcG9ydGluZyB0aGUgQVBJIGNsYXNzXHJcbmltcG9ydCB7IGhhbmRsZVN1Ym1pdCwgcmVuZGVyTG9hZGluZyB9IGZyb20gXCIuLi91dGlscy91dGlscy5qc1wiOyAvLyBJbXBvcnRpbmcgdXRpbGl0eSBmdW5jdGlvbnNcclxuXHJcbi8vIEltcG9ydGluZyBpbWFnZXMgYW5kIG90aGVyIGFzc2V0c1xyXG5pbXBvcnQgbG9nb1BhdGggZnJvbSBcIi4uL2ltYWdlcy9sb2dvLnN2Z1wiO1xyXG5pbXBvcnQgYXZhdGFyUGF0aCBmcm9tIFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIjtcclxuaW1wb3J0IGVkaXRCdXR0b25QYXRoIGZyb20gXCIuLi9pbWFnZXMvZWRpdGJ0bi5zdmdcIjtcclxuaW1wb3J0IGFkZEJ1dHRvblBhdGggZnJvbSBcIi4uL2ltYWdlcy9hZGRidG4uc3ZnXCI7XHJcbmltcG9ydCBlZGl0TGlnaHRCdXR0b25QYXRoIGZyb20gXCIuLi9pbWFnZXMvZWRpdGJ0bi1saWdodC5zdmdcIjtcclxuXHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyX19sb2dvXCIpLnNyYyA9IGxvZ29QYXRoO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKS5zcmMgPSBhdmF0YXJQYXRoO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uIGltZ1wiKS5zcmMgPSBlZGl0QnV0dG9uUGF0aDtcclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uIGltZ1wiKS5zcmMgPSBhZGRCdXR0b25QYXRoO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3BlbmNpbEljb25cIikuc3JjID0gZWRpdExpZ2h0QnV0dG9uUGF0aDtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImYxZjFkYmFiLThlMTctNDhkMy1hMDk4LWQ3N2RmZDZlYTNjNVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5sZXQgdXNlcklkO1xyXG5cclxuYXBpXHJcbiAgLmdldFVzZXJJbmZvKClcclxuICAudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcclxuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xyXG4gICAgcHJvZmlsZUF2YXRhci5zcmMgPSB1c2VyRGF0YS5hdmF0YXI7XHJcbiAgICByZXR1cm4gYXBpLmdldEluaXRpYWxDYXJkcygpO1xyXG4gIH0pXHJcbiAgLnRoZW4oKGNhcmRzKSA9PiB7XHJcbiAgICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZCk7XHJcbiAgICAgIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcblxyXG4vLyBQcm9maWxlIFNlbGVjdG9yc1xyXG5jb25zdCBlZGl0TW9kYWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBjYXJkTW9kYWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5cclxuLy8gTW9kYWwgU2VsZWN0b3JzXHJcbi8vIGNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XHJcbmNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKTtcclxuY29uc3QgZGVsZXRlRm9ybSA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWZvcm1cIik7XHJcbmNvbnN0IGNhbmNlbERlbGV0ZUJ1dHRvbiA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhbmNlbC1idXR0b25cIik7XHJcbmNvbnN0IGF2YXRhckVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1idXR0b25cIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXctYXZhdGFyLW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgYXZhdGFyTGlua0lucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNuZXctYXZhdGFyLWxpbmstaW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcclxuXHJcbi8vIE1vZGFsIC0gRWRpdCBQcm9maWxlXHJcbmNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1tb2RhbFwiKTtcclxuY29uc3QgZWRpdEZvcm0gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgZWRpdE1vZGFsTmFtZUlucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIpO1xyXG5jb25zdCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcblxyXG4vLyBNb2RhbCAtIEFkZCBDYXJkXHJcbmNvbnN0IGNhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LWNhcmQtbW9kYWxcIik7XHJcbmNvbnN0IGNhcmRGb3JtID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbi8vIGNvbnN0IGNhcmRTdWJtaXRCdXR0b24gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcclxuY29uc3QgY2FyZExpbmtJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI25ldy1jYXJkLWxpbmstaW5wdXRcIik7XHJcbmNvbnN0IGNhcmRDYXB0aW9uSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNuZXctY2FyZC1jYXB0aW9uLWlucHV0XCIpO1xyXG5cclxuLy8gTW9kYWwgUHJldmlld1xyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdJbWFnZSA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuY29uc3QgcHJldmlld0NhcHRpb24gPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuXHJcbi8vIENhcmRzXHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcclxuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuXHJcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNhcmRFbGVtZW50Ll9pZCA9IGRhdGEuX2lkO1xyXG5cclxuICBjb25zdCBjYXJkVGl0bGUgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gIGNvbnN0IGNhcmRJbWFnZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgY29uc3QgY2FyZExpa2VCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gIGNvbnN0IGNhcmRMaWtlQ291bnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRcIik7XHJcbiAgY29uc3QgY2FyZERlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuXHJcbiAgLy8gU2V0IGNhcmQgZGF0YVxyXG4gIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICBjYXJkSW1hZ2Uuc3JjID0gZGF0YS5saW5rOyAvLyBNYWtlIHN1cmUgdGhpcyBsaW5lIGlzIHByZXNlbnRcclxuICBjYXJkSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xyXG5cclxuICAvLyBTZXQgaW5pdGlhbCBsaWtlIHN0YXRlIGFuZCBjb3VudFxyXG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcclxuICAgIGNhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiKTtcclxuICAgIGNhcmRMaWtlQ291bnQudGV4dENvbnRlbnQgPSBcIjFcIjsgLy8gU2V0IHRvIDEgaWYgdGhlIGNhcmQgaXMgbGlrZWRcclxuICB9IGVsc2Uge1xyXG4gICAgY2FyZExpa2VDb3VudC50ZXh0Q29udGVudCA9IFwiMFwiOyAvLyBTZXQgdG8gMCBpZiB0aGUgY2FyZCBpcyBub3QgbGlrZWRcclxuICB9XHJcblxyXG4gIGNhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjb25zdCBpc0N1cnJlbnRseUxpa2VkID0gY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFxyXG4gICAgICBcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCJcclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgbGlrZUNhcmRQcm9taXNlID0gaXNDdXJyZW50bHlMaWtlZFxyXG4gICAgICA/IGFwaS5kaXNsaWtlQ2FyZChkYXRhLl9pZClcclxuICAgICAgOiBhcGkubGlrZUNhcmQoZGF0YS5faWQpO1xyXG5cclxuICAgIGxpa2VDYXJkUHJvbWlzZVxyXG4gICAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcclxuICAgICAgICBjYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFxyXG4gICAgICAgICAgXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiLFxyXG4gICAgICAgICAgdXBkYXRlZENhcmQuaXNMaWtlZFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY2FyZExpa2VDb3VudC50ZXh0Q29udGVudCA9IHVwZGF0ZWRDYXJkLmlzTGlrZWQgPyBcIjFcIiA6IFwiMFwiO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIGxpa2Ugc3RhdHVzOlwiLCBlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAvLyBkZWxldGUgYW5kIHByZXZpZXcgZXZlbnQgbGlzdGVuZXJzXHJcbiAgY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcclxuICAgIGRlbGV0ZUZvcm0uX2NhcmRUb0RlbGV0ZSA9IGNhcmRFbGVtZW50O1xyXG4gIH0pO1xyXG5cclxuICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xyXG4gICAgcHJldmlld0NhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICBwcmV2aWV3SW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgcHJldmlld0ltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG5cclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlT3ZlcmxheUNsaWNrKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGVLZXlQcmVzcyk7XHJcblxyXG4gIG1vZGFsLl9oYW5kbGVPdmVybGF5Q2xpY2sgPSBoYW5kbGVPdmVybGF5Q2xpY2s7XHJcbiAgbW9kYWwuX2hhbmRsZUVzY2FwZUtleVByZXNzID0gaGFuZGxlRXNjYXBlS2V5UHJlc3M7XHJcblxyXG4gIGZ1bmN0aW9uIGhhbmRsZU92ZXJsYXlDbGljayhldmVudCkge1xyXG4gICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcclxuICAgICAgY2xvc2VNb2RhbChtb2RhbCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBoYW5kbGVFc2NhcGVLZXlQcmVzcyhldmVudCkge1xyXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICBjbG9zZU1vZGFsKG1vZGFsKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG5cclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgbW9kYWwuX2hhbmRsZU92ZXJsYXlDbGljayk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgbW9kYWwuX2hhbmRsZUVzY2FwZUtleVByZXNzKTtcclxufVxyXG5cclxuLy8gZnVuY3Rpb24gcmVuZGVyTG9hZGluZyhcclxuLy8gaXNMb2FkaW5nLFxyXG4vLyBidXR0b24sXHJcbi8vIGJ1dHRvblRleHQgPSBcIlNhdmVcIixcclxuLy8gbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiXHJcbi8vICkge1xyXG4vLyBidXR0b24udGV4dENvbnRlbnQgPSBpc0xvYWRpbmcgPyBsb2FkaW5nVGV4dCA6IGJ1dHRvblRleHQ7XHJcbi8vIH1cclxuXHJcbi8vIFVuaXZlcnNhbCBDbG9zZSBCdXR0b24gSGFuZGxlclxyXG5jbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcbiAgY29uc3QgbW9kYWwgPSBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKTtcclxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwobW9kYWwpKTtcclxufSk7XHJcblxyXG4vLyBIYW5kbGVyc1xyXG5mdW5jdGlvbiBtYWtlRWRpdFByb2ZpbGVSZXF1ZXN0KCkge1xyXG4gIC8vIEdldCBmb3JtIHZhbHVlc1xyXG4gIGNvbnN0IG5hbWUgPSBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWU7XHJcbiAgY29uc3QgYWJvdXQgPSBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlO1xyXG5cclxuICAvLyBNYWtlIEFQSSBjYWxsIHRvIGVkaXQgdXNlciBpbmZvXHJcbiAgcmV0dXJuIGFwaS5lZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KS50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgLy8gVXBkYXRlIHRoZSBET00gd2l0aCB0aGUgbmV3IHVzZXIgZGF0YVxyXG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlckRhdGEuYWJvdXQ7XHJcbiAgICAvLyBDbG9zZSB0aGUgbW9kYWxcclxuICAgIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgaGFuZGxlU3VibWl0KG1ha2VFZGl0UHJvZmlsZVJlcXVlc3QsIGV2dCwgXCJTYXZpbmcuLi5cIik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRGb3JtU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGNhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIik7XHJcbiAgcmVuZGVyTG9hZGluZyh0cnVlLCBzdWJtaXRCdXR0b24pO1xyXG5cclxuICBhcGlcclxuICAgIC5hZGRDYXJkKHtcclxuICAgICAgbmFtZTogY2FyZENhcHRpb25JbnB1dC52YWx1ZSxcclxuICAgICAgbGluazogY2FyZExpbmtJbnB1dC52YWx1ZSxcclxuICAgIH0pXHJcbiAgICAudGhlbigoY2FyZERhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkRGF0YSk7XHJcbiAgICAgIGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIHN1Ym1pdEJ1dHRvbik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8gRWRpdCBNb2RhbCBMaXN0ZW5lcnNcclxuZWRpdE1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuICByZXNldFZhbGlkYXRpb24oXHJcbiAgICBlZGl0Rm9ybSxcclxuICAgIFtlZGl0TW9kYWxOYW1lSW5wdXQsIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXRdLFxyXG4gICAgc2V0dGluZ3NcclxuICApO1xyXG4gIG9wZW5Nb2RhbChlZGl0TW9kYWwpO1xyXG59KTtcclxuXHJcbi8vIEF2YXRhciBNb2RhbCBMaXN0ZW5lclxyXG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgb3Blbk1vZGFsKGF2YXRhck1vZGFsKTtcclxufSk7XHJcblxyXG4vLyBDYXJkIE1vZGFsIExpc3RlbmVyc1xyXG5jYXJkTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoY2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5jYW5jZWxEZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufSk7XHJcblxyXG4vLyBGb3JtIExpc3RlbmVyc1xyXG5lZGl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRGb3JtU3VibWl0KTtcclxuY2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVDYXJkRm9ybVN1Ym1pdCk7XHJcblxyXG5kZWxldGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRlbGV0ZUZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcclxuICByZW5kZXJMb2FkaW5nKHRydWUsIHN1Ym1pdEJ1dHRvbiwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcclxuXHJcbiAgYXBpXHJcbiAgICAucmVtb3ZlQ2FyZChkZWxldGVGb3JtLl9jYXJkVG9EZWxldGUuX2lkKSAvLyBDaGFuZ2VkIGZyb20gZGVsZXRlQ2FyZCB0byByZW1vdmVDYXJkXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGhhbmRsZVN1Ym1pdCgoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlRm9ybS5fY2FyZFRvRGVsZXRlLnJlbW92ZSgpO1xyXG4gICAgICB9KTtcclxuICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIHN1Ym1pdEJ1dHRvbiwgXCJEZWxldGVcIik7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG4vLyBBdmF0YXIgRm9ybSBTdWJtaXQgSGFuZGxlclxyXG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGF2YXRhckZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcclxuICByZW5kZXJMb2FkaW5nKHRydWUsIHN1Ym1pdEJ1dHRvbik7XHJcblxyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZUF2YXRhcih7XHJcbiAgICAgIGF2YXRhcjogYXZhdGFyTGlua0lucHV0LnZhbHVlLFxyXG4gICAgfSlcclxuICAgIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcclxuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgc3VibWl0QnV0dG9uKTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgX3JlcXVlc3QoZW5kcG9pbnQsIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgY29uc3QgZmluYWxPcHRpb25zID0ge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAuLi5vcHRpb25zLFxyXG4gICAgfTtcclxuICAgIGNvbnN0IHVybCA9IGAke3RoaXMuX2Jhc2VVcmx9JHtlbmRwb2ludH1gO1xyXG4gICAgcmV0dXJuIGZldGNoKHVybCwgZmluYWxPcHRpb25zKS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi91c2Vycy9tZVwiKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL2NhcmRzXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQQVRDSCAvdXNlcnMvbWVcclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGFib3V0IH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQQVRDSCAvdXNlcnMvbWUvYXZhdGFyXHJcbiAgdXBkYXRlQXZhdGFyKHsgYXZhdGFyIH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL3VzZXJzL21lL2F2YXRhclwiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhciB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gUE9TVCAvY2FyZHNcclxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi9jYXJkc1wiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gREVMRVRFIC9jYXJkcy86Y2FyZElkXHJcbiAgcmVtb3ZlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICAvLyBQVVQgL2NhcmRzLzpjYXJkSWQvbGlrZXNcclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAvY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIERFTEVURSAvY2FyZHMvOmNhcmRJZC9saWtlc1xyXG4gIGRpc2xpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gSGVscGVyOiBGZXRjaCBpbml0aWFsIGRhdGEgc2ltdWx0YW5lb3VzbHkgKHVzZXIgaW5mbyAmIGNhcmRzKVxyXG4gIGZldGNoSW5pdGlhbERhdGEoKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJsb2dFcnJvciIsIm1lc3NhZ2UiLCJjb25zb2xlIiwiZXJyb3IiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwicmVtb3ZlQXR0cmlidXRlIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50Iiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImFkZCIsInJlc2V0VmFsaWRhdGlvbiIsImZvckVhY2giLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiYnV0dG9uIiwiYnV0dG9uVGV4dCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImxvYWRpbmdUZXh0IiwiaGFuZGxlU3VibWl0IiwicmVxdWVzdCIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwic3VibWl0QnV0dG9uIiwic3VibWl0dGVyIiwiaW5pdGlhbFRleHQiLCJjYXRjaCIsImZpbmFsbHkiLCJkb2N1bWVudCIsInNyYyIsImxvZ29QYXRoIiwiYXZhdGFyUGF0aCIsImVkaXRCdXR0b25QYXRoIiwiYWRkQnV0dG9uUGF0aCIsImVkaXRMaWdodEJ1dHRvblBhdGgiLCJhcGkiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJlbmRwb2ludCIsImZpbmFsT3B0aW9ucyIsInVybCIsImZldGNoIiwidGhlbiIsImdldFVzZXJJbmZvIiwiZ2V0SW5pdGlhbENhcmRzIiwibWV0aG9kIiwiZWRpdFVzZXJJbmZvIiwiX3JlZiIsIm5hbWUiLCJhYm91dCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidXBkYXRlQXZhdGFyIiwiX3JlZjIiLCJhdmF0YXIiLCJhZGRDYXJkIiwiX3JlZjMiLCJsaW5rIiwicmVtb3ZlQ2FyZCIsImNhcmRJZCIsImxpa2VDYXJkIiwiZGlzbGlrZUNhcmQiLCJmZXRjaEluaXRpYWxEYXRhIiwiYWxsIiwiYXV0aG9yaXphdGlvbiIsInVzZXJJZCIsInVzZXJEYXRhIiwiX2lkIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJwcm9maWxlQXZhdGFyIiwiY2FyZHMiLCJjYXJkIiwiY2FyZEVsZW1lbnQiLCJnZXRDYXJkRWxlbWVudCIsImNhcmRzTGlzdCIsImFwcGVuZCIsImVkaXRNb2RhbEJ1dHRvbiIsImNhcmRNb2RhbEJ1dHRvbiIsImNsb3NlQnV0dG9ucyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJkZWxldGVNb2RhbCIsImRlbGV0ZUZvcm0iLCJjYW5jZWxEZWxldGVCdXR0b24iLCJhdmF0YXJFZGl0QnV0dG9uIiwiYXZhdGFyTW9kYWwiLCJhdmF0YXJGb3JtIiwiYXZhdGFyTGlua0lucHV0IiwiZWRpdE1vZGFsIiwiZWRpdEZvcm0iLCJlZGl0TW9kYWxOYW1lSW5wdXQiLCJlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0IiwiY2FyZE1vZGFsIiwiY2FyZEZvcm0iLCJjYXJkTGlua0lucHV0IiwiY2FyZENhcHRpb25JbnB1dCIsInByZXZpZXdNb2RhbCIsInByZXZpZXdJbWFnZSIsInByZXZpZXdDYXB0aW9uIiwiY2FyZFRlbXBsYXRlIiwiZGF0YSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkVGl0bGUiLCJjYXJkSW1hZ2UiLCJjYXJkTGlrZUJ1dHRvbiIsImNhcmRMaWtlQ291bnQiLCJjYXJkRGVsZXRlQnV0dG9uIiwiYWx0IiwiaXNMaWtlZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJjb250YWlucyIsInVwZGF0ZWRDYXJkIiwidG9nZ2xlIiwib3Blbk1vZGFsIiwiX2NhcmRUb0RlbGV0ZSIsIm1vZGFsIiwiaGFuZGxlT3ZlcmxheUNsaWNrIiwiZXZlbnQiLCJ0YXJnZXQiLCJjbG9zZU1vZGFsIiwiaGFuZGxlRXNjYXBlS2V5UHJlc3MiLCJrZXkiLCJfaGFuZGxlT3ZlcmxheUNsaWNrIiwiX2hhbmRsZUVzY2FwZUtleVByZXNzIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIm1ha2VFZGl0UHJvZmlsZVJlcXVlc3QiLCJ2YWx1ZSIsImNsb3Nlc3QiLCJjYXJkRGF0YSIsInByZXBlbmQiLCJyZXNldCIsIkFycmF5IiwiZnJvbSIsInNldEV2ZW50TGlzdGVuZXJzIiwiY2hlY2tJbnB1dFZhbGlkaXR5Iiwic2hvd0lucHV0RXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJzZXRBdHRyaWJ1dGUiLCJ2YWxpZGF0aW9uTWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=