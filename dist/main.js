!function(){"use strict";var e="/se_project_spots/";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-button",inactiveButtonClass:"modal__submit-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error"},r=e=>{console.error(`Validation Error: ${e}`)},o=(e,t,o)=>{const n=e.querySelector(`#${t.id}-error`);n?(n.textContent="",n.removeAttribute("role"),t.classList.remove(o.inputErrorClass)):r(`Error message element for input ${t.id} not found.`)},n=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?a(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},a=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},c=(e,t,r)=>{t.forEach((t=>{o(e,t,r)}));const n=e.querySelector(r.submitButtonSelector);a(n,r)};function s(e,t,r="Save",o="Saving..."){t.textContent=e?o:r}function l(e,t,r="Saving..."){t.preventDefault();const o=t.submitter,n=o.textContent;return s(!0,o,n,r),e().catch(console.error).finally((()=>{s(!1,o,n)}))}var i=e+"5e2464bff616faf70484.svg",d=e+"2fc47fd8e9a9bcd9612f.jpg",u=e+"49e44e5e03758262e8bf.svg",m=e+"975792ea68af0a3c209d.svg",_=e+"c81b22e9874268723f8d.svg";document.querySelector(".header__logo").src=i,document.querySelector(".profile__avatar").src=d,document.querySelector(".profile__edit-button img").src=u,document.querySelector(".profile__add-button img").src=m,document.querySelector(".profile__pencilIcon").src=_;const v=new class{constructor(e){this._baseUrl=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t={}){const r={headers:this._headers,...t},o=`${this._baseUrl}${e}`;return fetch(o,r).then(this._checkResponse)}getUserInfo(){return this._request("/users/me")}getInitialCards(){return this._request("/cards",{method:"GET"})}editUserInfo({name:e,about:t}){return this._request("/users/me",{method:"PATCH",body:JSON.stringify({name:e,about:t})})}updateAvatar({avatar:e}){return this._request("/users/me/avatar",{method:"PATCH",body:JSON.stringify({avatar:e})})}addCard({name:e,link:t}){return this._request("/cards",{method:"POST",body:JSON.stringify({name:e,link:t})})}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return this._request(`/cards/${e}/likes`,{method:"PUT"})}dislikeCard(e){return this._request(`/cards/${e}/likes`,{method:"DELETE"})}fetchInitialData(){return Promise.all([this.getUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f1f1dbab-8e17-48d3-a098-d77dfd6ea3c5","Content-Type":"application/json"}});let f;v.getUserInfo().then((e=>(f=e._id,h.textContent=e.name,S.textContent=e.about,D.src=e.avatar,v.getInitialCards()))).then((e=>{e.forEach((e=>{const t=H(e);R.append(t)}))})).catch(console.error);const y=document.querySelector(".profile__edit-button"),p=document.querySelector(".profile__add-button"),h=document.querySelector(".profile__name"),S=document.querySelector(".profile__description"),q=document.querySelectorAll(".modal__close-button"),b=document.querySelector("#delete-modal"),k=b.querySelector("#delete-form"),E=b.querySelector(".modal__cancel-button"),C=document.querySelector(".profile__avatar-button"),L=document.querySelector("#new-avatar-modal"),g=L.querySelector(".modal__form"),x=L.querySelector("#new-avatar-link-input"),D=document.querySelector(".profile__avatar"),A=document.querySelector("#edit-modal"),$=A.querySelector(".modal__form"),T=A.querySelector("#profile-name-input"),U=A.querySelector("#profile-description-input"),I=document.querySelector("#new-card-modal"),w=I.querySelector(".modal__form"),P=I.querySelector("#new-card-link-input"),B=I.querySelector("#new-card-caption-input"),O=document.querySelector("#preview-modal"),j=O.querySelector(".modal__image"),N=O.querySelector(".modal__caption"),J=document.querySelector("#card-template"),R=document.querySelector(".cards__list");function H(e){const t=J.content.querySelector(".card").cloneNode(!0);t._id=e._id;const r=t.querySelector(".card__title"),o=t.querySelector(".card__image"),n=t.querySelector(".card__like-button"),a=t.querySelector(".card__like-count"),c=t.querySelector(".card__delete-button");return r.textContent=e.name,o.src=e.link,o.alt=e.name,e.isLiked?(n.classList.add("card__like-button_liked"),a.textContent="1"):a.textContent="0",n.addEventListener("click",(()=>{(n.classList.contains("card__like-button_liked")?v.dislikeCard(e._id):v.likeCard(e._id)).then((e=>{n.classList.toggle("card__like-button_liked",e.isLiked),a.textContent=e.isLiked?"1":"0"})).catch((e=>{console.error("Error updating like status:",e)}))})),c.addEventListener("click",(()=>{K(b),k._cardToDelete=t})),o.addEventListener("click",(()=>{K(O),N.textContent=e.name,j.alt=e.name,j.src=e.link})),t}function K(e){function t(t){t.target.classList.contains("modal_opened")&&z(e)}function r(t){"Escape"===t.key&&z(e)}e.classList.add("modal_opened"),document.addEventListener("click",t),document.addEventListener("keydown",r),e._handleOverlayClick=t,e._handleEscapeKeyPress=r}function z(e){e.classList.remove("modal_opened"),document.removeEventListener("click",e._handleOverlayClick),document.removeEventListener("keydown",e._handleEscapeKeyPress)}function G(){const e=T.value,t=U.value;return v.editUserInfo({name:e,about:t}).then((e=>{h.textContent=e.name,S.textContent=e.about,z(A)}))}var M;q.forEach((e=>{const t=e.closest(".modal");e.addEventListener("click",(()=>z(t)))})),y.addEventListener("click",(()=>{T.value=h.textContent,U.value=S.textContent,c($,[T,U],t),K(A)})),C.addEventListener("click",(()=>{K(L)})),p.addEventListener("click",(()=>{K(I)})),E.addEventListener("click",(()=>{z(b)})),$.addEventListener("submit",(function(e){l(G,e,"Saving...")})),w.addEventListener("submit",(function(e){e.preventDefault();const t=w.querySelector(".modal__submit-button");s(!0,t),v.addCard({name:B.value,link:P.value}).then((t=>{const r=H(t);R.prepend(r),e.target.reset(),z(I)})).catch(console.error).finally((()=>{s(!1,t)}))})),k.addEventListener("submit",(e=>{e.preventDefault();const t=k.querySelector(".modal__submit-button");s(!0,t,"Delete","Deleting..."),v.removeCard(k._cardToDelete._id).then((()=>{l((()=>{k._cardToDelete.remove()})),z(b)})).catch(console.error).finally((()=>{s(!1,t,"Delete")}))})),g.addEventListener("submit",(e=>{e.preventDefault();const t=g.querySelector(".modal__submit-button");s(!0,t),v.updateAvatar({avatar:x.value}).then((t=>{D.src=t.avatar,e.target.reset(),z(L)})).catch(console.error).finally((()=>{s(!1,t)}))})),M=t,document.querySelectorAll(M.formSelector).forEach((e=>{const t=Array.from(e.querySelectorAll(M.inputSelector));((e,t)=>{const a=Array.from(e.querySelectorAll(t.inputSelector)),c=e.querySelector(t.submitButtonSelector);n(a,c,t),a.forEach((s=>{s.addEventListener("input",(()=>{((e,t,n)=>{t.validity.valid?o(e,t,n):((e,t,o,n)=>{const a=e.querySelector(`#${t.id}-error`);a?(a.textContent=o,a.setAttribute("role","alert"),t.classList.add(n.inputErrorClass)):r(`Error message element for input ${t.id} not found.`)})(e,t,t.validationMessage,n)})(e,s,t),n(a,c,t)}))}))})(e,M),e.addEventListener("reset",(()=>{c(e,t,M)}))}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQU9aLGdCQXRCaEJvSyxFQUFDMUosRUFBYUUsS0FDdEMsTUFBTVMsRUFBWTZJLE1BQU1DLEtBQ3RCekosRUFBWW9HLGlCQUFpQmxHLEVBQU9aLGdCQUVoQ3NCLEVBQWdCWixFQUFZSSxjQUFjRixFQUFPWCxzQkFFdkRtQixFQUFrQkMsRUFBV0MsRUFBZVYsR0FFNUNTLEVBQVVXLFNBQVNyQixJQUNqQkEsRUFBYWlJLGlCQUFpQixTQUFTLEtBdERoQnlCLEVBQUMzSixFQUFhQyxFQUFjQyxLQUNoREQsRUFBYWMsU0FBU0MsTUFRekJqQixFQUFlQyxFQUFhQyxFQUFjQyxHQXpDdkIwSixFQUFDNUosRUFBYUMsRUFBYzRKLEVBQWMzSixLQUMvRCxNQUFNQyxFQUFzQkgsRUFBWUksY0FDdEMsSUFBSUgsRUFBYUksWUFHZEYsR0FLTEEsRUFBb0JHLFlBQWN1SixFQUNsQzFKLEVBQW9CMkosYUFBYSxPQUFRLFNBQ3pDN0osRUFBYU8sVUFBVVksSUFBSWxCLEVBQU9ULGtCQU5oQ0UsRUFBUyxtQ0FBbUNNLEVBQWFJLGdCQU1ULEVBc0JoRHVKLENBQ0U1SixFQUNBQyxFQUNBQSxFQUFhOEosa0JBQ2I3SixFQUlKLEVBNkNJeUosQ0FBbUIzSixFQUFhQyxFQUFjQyxHQUM5Q1EsRUFBa0JDLEVBQVdDLEVBQWVWLEVBQU8sR0FDbkQsR0FDRixFQVdBd0osQ0FBa0IxSixFQUFhRSxHQUcvQkYsRUFBWWtJLGlCQUFpQixTQUFTLEtBQ3BDN0csRUFBZ0JyQixFQUFhVyxFQUFXVCxFQUFPLEdBQy9DLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy91dGlscy5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvdXRpbHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIi9zZV9wcm9qZWN0X3Nwb3RzL1wiOyIsImV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zdWJtaXQtYnV0dG9uXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yXCIsXHJcbn07XHJcblxyXG4vLyBVdGlsaXR5IGZvciBsb2dnaW5nIGVycm9yc1xyXG5jb25zdCBsb2dFcnJvciA9IChtZXNzYWdlKSA9PiB7XHJcbiAgY29uc29sZS5lcnJvcihgVmFsaWRhdGlvbiBFcnJvcjogJHttZXNzYWdlfWApO1xyXG59O1xyXG5cclxuLy8gU2hvdyBpbnB1dCBlcnJvciBtZXNzYWdlXHJcbmNvbnN0IHNob3dJbnB1dEVycm9yID0gKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICApO1xyXG5cclxuICBpZiAoIWVycm9yTWVzc2FnZUVsZW1lbnQpIHtcclxuICAgIGxvZ0Vycm9yKGBFcnJvciBtZXNzYWdlIGVsZW1lbnQgZm9yIGlucHV0ICR7aW5wdXRFbGVtZW50LmlkfSBub3QgZm91bmQuYCk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gIGVycm9yTWVzc2FnZUVsZW1lbnQuc2V0QXR0cmlidXRlKFwicm9sZVwiLCBcImFsZXJ0XCIpOyAvLyBBY2Nlc3NpYmlsaXR5IGVuaGFuY2VtZW50XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG4vLyBIaWRlIGlucHV0IGVycm9yIG1lc3NhZ2VcclxuY29uc3QgaGlkZUlucHV0RXJyb3IgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JNZXNzYWdlRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICApO1xyXG5cclxuICBpZiAoIWVycm9yTWVzc2FnZUVsZW1lbnQpIHtcclxuICAgIGxvZ0Vycm9yKGBFcnJvciBtZXNzYWdlIGVsZW1lbnQgZm9yIGlucHV0ICR7aW5wdXRFbGVtZW50LmlkfSBub3QgZm91bmQuYCk7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG5cclxuICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcclxuICBlcnJvck1lc3NhZ2VFbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcInJvbGVcIik7XHJcbiAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcblxyXG4vLyBDaGVjayBpbnB1dCB2YWxpZGl0eVxyXG5jb25zdCBjaGVja0lucHV0VmFsaWRpdHkgPSAoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgIHNob3dJbnB1dEVycm9yKFxyXG4gICAgICBmb3JtRWxlbWVudCxcclxuICAgICAgaW5wdXRFbGVtZW50LFxyXG4gICAgICBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UsXHJcbiAgICAgIGNvbmZpZ1xyXG4gICAgKTtcclxuICB9IGVsc2Uge1xyXG4gICAgaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCwgY29uZmlnKTtcclxuICB9XHJcbn07XHJcblxyXG4vLyBDaGVjayBpZiBmb3JtIGhhcyBpbnZhbGlkIGlucHV0XHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiAhaW5wdXQudmFsaWRpdHkudmFsaWQpO1xyXG59O1xyXG5cclxuLy8gVG9nZ2xlIGJ1dHRvbiBzdGF0ZVxyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGlmIChoYXNJbnZhbGlkSW5wdXQoaW5wdXRMaXN0KSkge1xyXG4gICAgZGlzYWJsZUJ1dHRvbihidXR0b25FbGVtZW50LCBjb25maWcpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBidXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH1cclxufTtcclxuXHJcbi8vIERpc2FibGUgYnV0dG9uXHJcbmNvbnN0IGRpc2FibGVCdXR0b24gPSAoYnV0dG9uRWxlbWVudCwgY29uZmlnKSA9PiB7XHJcbiAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxufTtcclxuXHJcbi8vIFJlc2V0IHZhbGlkYXRpb25cclxuZXhwb3J0IGNvbnN0IHJlc2V0VmFsaWRhdGlvbiA9IChmb3JtRWxlbWVudCwgaW5wdXRMaXN0LCBjb25maWcpID0+IHtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dCwgY29uZmlnKTtcclxuICB9KTtcclxuXHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICBkaXNhYmxlQnV0dG9uKGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7IC8vIERpc2FibGUgdGhlIGJ1dHRvbiBkdXJpbmcgcmVzZXRcclxufTtcclxuXHJcbi8vIEFkZCBldmVudCBsaXN0ZW5lcnMgdG8gdGhlIGZvcm1cclxuY29uc3Qgc2V0RXZlbnRMaXN0ZW5lcnMgPSAoZm9ybUVsZW1lbnQsIGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5pbnB1dFNlbGVjdG9yKVxyXG4gICk7XHJcbiAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoY29uZmlnLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50LCBjb25maWcpOyAvLyBJbml0aWFsIGJ1dHRvbiBzdGF0ZSBjaGVja1xyXG5cclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTsgLy8gVXBkYXRlIGJ1dHRvbiBzdGF0ZSBvbiBpbnB1dFxyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vLyBFbmFibGUgdmFsaWRhdGlvbiBmb3IgYWxsIGZvcm1zXHJcbmV4cG9ydCBjb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChjb25maWcuZm9ybVNlbGVjdG9yKTtcclxuXHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uZmlnLmlucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQsIGNvbmZpZyk7XHJcblxyXG4gICAgLy8gQ2xlYXIgdmFsaWRhdGlvbiBvbiBmb3JtIHJlc2V0XHJcbiAgICBmb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwicmVzZXRcIiwgKCkgPT4ge1xyXG4gICAgICByZXNldFZhbGlkYXRpb24oZm9ybUVsZW1lbnQsIGlucHV0TGlzdCwgY29uZmlnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG4iLCJleHBvcnQgZnVuY3Rpb24gcmVuZGVyTG9hZGluZyhcclxuICBpc0xvYWRpbmcsXHJcbiAgYnV0dG9uLFxyXG4gIGJ1dHRvblRleHQgPSBcIlNhdmVcIixcclxuICBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCJcclxuKSB7XHJcbiAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgYnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbi50ZXh0Q29udGVudCA9IGJ1dHRvblRleHQ7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlU3VibWl0KHJlcXVlc3QsIGV2dCwgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgY29uc3Qgc3VibWl0QnV0dG9uID0gZXZ0LnN1Ym1pdHRlcjtcclxuICBjb25zdCBpbml0aWFsVGV4dCA9IHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuXHJcbiAgcmVuZGVyTG9hZGluZyh0cnVlLCBzdWJtaXRCdXR0b24sIGluaXRpYWxUZXh0LCBsb2FkaW5nVGV4dCk7XHJcblxyXG4gIHJldHVybiByZXF1ZXN0KClcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICByZW5kZXJMb2FkaW5nKGZhbHNlLCBzdWJtaXRCdXR0b24sIGluaXRpYWxUZXh0KTtcclxuICAgIH0pO1xyXG59XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7IC8vIEltcG9ydGluZyB0aGUgQ1NTIGZpbGVcclxuaW1wb3J0IHtcclxuICBlbmFibGVWYWxpZGF0aW9uLFxyXG4gIHNldHRpbmdzLFxyXG4gIHJlc2V0VmFsaWRhdGlvbixcclxufSBmcm9tIFwiLi4vc2NyaXB0cy92YWxpZGF0aW9uLmpzXCI7IC8vIEltcG9ydGluZyB2YWxpZGF0aW9uIGZ1bmN0aW9uc1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjsgLy8gSW1wb3J0aW5nIHRoZSBBUEkgY2xhc3NcclxuaW1wb3J0IHsgaGFuZGxlU3VibWl0LCByZW5kZXJMb2FkaW5nIH0gZnJvbSBcIi4uL3V0aWxzL3V0aWxzLmpzXCI7IC8vIEltcG9ydGluZyB1dGlsaXR5IGZ1bmN0aW9uc1xyXG5cclxuLy8gSW1wb3J0aW5nIGltYWdlcyBhbmQgb3RoZXIgYXNzZXRzXHJcbmltcG9ydCBsb2dvUGF0aCBmcm9tIFwiLi4vaW1hZ2VzL2xvZ28uc3ZnXCI7XHJcbmltcG9ydCBhdmF0YXJQYXRoIGZyb20gXCIuLi9pbWFnZXMvYXZhdGFyLmpwZ1wiO1xyXG5pbXBvcnQgZWRpdEJ1dHRvblBhdGggZnJvbSBcIi4uL2ltYWdlcy9lZGl0YnRuLnN2Z1wiO1xyXG5pbXBvcnQgYWRkQnV0dG9uUGF0aCBmcm9tIFwiLi4vaW1hZ2VzL2FkZGJ0bi5zdmdcIjtcclxuaW1wb3J0IGVkaXRMaWdodEJ1dHRvblBhdGggZnJvbSBcIi4uL2ltYWdlcy9lZGl0YnRuLWxpZ2h0LnN2Z1wiO1xyXG5cclxuLy8gRW5zdXJlIHNtYWxsdGFibGV0dmlldy5wbmcgaXMgY29waWVkIHRvIGRpc3RcclxuaW1wb3J0IFwiLi9fY29weV9zbWFsbHRhYmxldHZpZXcuanNcIjtcclxuXHJcbmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyX19sb2dvXCIpLnNyYyA9IGxvZ29QYXRoO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKS5zcmMgPSBhdmF0YXJQYXRoO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uIGltZ1wiKS5zcmMgPSBlZGl0QnV0dG9uUGF0aDtcclxuZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uIGltZ1wiKS5zcmMgPSBhZGRCdXR0b25QYXRoO1xyXG5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3BlbmNpbEljb25cIikuc3JjID0gZWRpdExpZ2h0QnV0dG9uUGF0aDtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImYxZjFkYmFiLThlMTctNDhkMy1hMDk4LWQ3N2RmZDZlYTNjNVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5sZXQgdXNlcklkO1xyXG5cclxuYXBpXHJcbiAgLmdldFVzZXJJbmZvKClcclxuICAudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgIHVzZXJJZCA9IHVzZXJEYXRhLl9pZDtcclxuICAgIHByb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdXNlckRhdGEubmFtZTtcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IHVzZXJEYXRhLmFib3V0O1xyXG4gICAgcHJvZmlsZUF2YXRhci5zcmMgPSB1c2VyRGF0YS5hdmF0YXI7XHJcbiAgICByZXR1cm4gYXBpLmdldEluaXRpYWxDYXJkcygpO1xyXG4gIH0pXHJcbiAgLnRoZW4oKGNhcmRzKSA9PiB7XHJcbiAgICBjYXJkcy5mb3JFYWNoKChjYXJkKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoY2FyZCk7XHJcbiAgICAgIGNhcmRzTGlzdC5hcHBlbmQoY2FyZEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcblxyXG4vLyBQcm9maWxlIFNlbGVjdG9yc1xyXG5jb25zdCBlZGl0TW9kYWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBjYXJkTW9kYWxCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19uYW1lXCIpO1xyXG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5cclxuLy8gTW9kYWwgU2VsZWN0b3JzXHJcbi8vIGNvbnN0IG1vZGFscyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxcIik7XHJcbmNvbnN0IGNsb3NlQnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcclxuY29uc3QgZGVsZXRlTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1tb2RhbFwiKTtcclxuY29uc3QgZGVsZXRlRm9ybSA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWZvcm1cIik7XHJcbmNvbnN0IGNhbmNlbERlbGV0ZUJ1dHRvbiA9IGRlbGV0ZU1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2NhbmNlbC1idXR0b25cIik7XHJcbmNvbnN0IGF2YXRhckVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1idXR0b25cIik7XHJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuZXctYXZhdGFyLW1vZGFsXCIpO1xyXG5jb25zdCBhdmF0YXJGb3JtID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgYXZhdGFyTGlua0lucHV0ID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIiNuZXctYXZhdGFyLWxpbmstaW5wdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcclxuXHJcbi8vIE1vZGFsIC0gRWRpdCBQcm9maWxlXHJcbmNvbnN0IGVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1tb2RhbFwiKTtcclxuY29uc3QgZWRpdEZvcm0gPSBlZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgZWRpdE1vZGFsTmFtZUlucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1uYW1lLWlucHV0XCIpO1xyXG5jb25zdCBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0ID0gZWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXHJcbik7XHJcblxyXG4vLyBNb2RhbCAtIEFkZCBDYXJkXHJcbmNvbnN0IGNhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LWNhcmQtbW9kYWxcIik7XHJcbmNvbnN0IGNhcmRGb3JtID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbi8vIGNvbnN0IGNhcmRTdWJtaXRCdXR0b24gPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcclxuY29uc3QgY2FyZExpbmtJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI25ldy1jYXJkLWxpbmstaW5wdXRcIik7XHJcbmNvbnN0IGNhcmRDYXB0aW9uSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNuZXctY2FyZC1jYXB0aW9uLWlucHV0XCIpO1xyXG5cclxuLy8gTW9kYWwgUHJldmlld1xyXG5jb25zdCBwcmV2aWV3TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3ByZXZpZXctbW9kYWxcIik7XHJcbmNvbnN0IHByZXZpZXdJbWFnZSA9IHByZXZpZXdNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuY29uc3QgcHJldmlld0NhcHRpb24gPSBwcmV2aWV3TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuXHJcbi8vIENhcmRzXHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcclxuY29uc3QgY2FyZHNMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcclxuXHJcbmZ1bmN0aW9uIGdldENhcmRFbGVtZW50KGRhdGEpIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmRUZW1wbGF0ZS5jb250ZW50XHJcbiAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIGNhcmRFbGVtZW50Ll9pZCA9IGRhdGEuX2lkO1xyXG5cclxuICBjb25zdCBjYXJkVGl0bGUgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpO1xyXG4gIGNvbnN0IGNhcmRJbWFnZSA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgY29uc3QgY2FyZExpa2VCdXR0b24gPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gIGNvbnN0IGNhcmRMaWtlQ291bnQgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRcIik7XHJcbiAgY29uc3QgY2FyZERlbGV0ZUJ1dHRvbiA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKTtcclxuXHJcbiAgLy8gU2V0IGNhcmQgZGF0YVxyXG4gIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcclxuICBjYXJkSW1hZ2Uuc3JjID0gZGF0YS5saW5rOyAvLyBNYWtlIHN1cmUgdGhpcyBsaW5lIGlzIHByZXNlbnRcclxuICBjYXJkSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xyXG5cclxuICAvLyBTZXQgaW5pdGlhbCBsaWtlIHN0YXRlIGFuZCBjb3VudFxyXG4gIGlmIChkYXRhLmlzTGlrZWQpIHtcclxuICAgIGNhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiKTtcclxuICAgIGNhcmRMaWtlQ291bnQudGV4dENvbnRlbnQgPSBcIjFcIjsgLy8gU2V0IHRvIDEgaWYgdGhlIGNhcmQgaXMgbGlrZWRcclxuICB9IGVsc2Uge1xyXG4gICAgY2FyZExpa2VDb3VudC50ZXh0Q29udGVudCA9IFwiMFwiOyAvLyBTZXQgdG8gMCBpZiB0aGUgY2FyZCBpcyBub3QgbGlrZWRcclxuICB9XHJcblxyXG4gIGNhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBjb25zdCBpc0N1cnJlbnRseUxpa2VkID0gY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKFxyXG4gICAgICBcImNhcmRfX2xpa2UtYnV0dG9uX2xpa2VkXCJcclxuICAgICk7XHJcblxyXG4gICAgY29uc3QgbGlrZUNhcmRQcm9taXNlID0gaXNDdXJyZW50bHlMaWtlZFxyXG4gICAgICA/IGFwaS5kaXNsaWtlQ2FyZChkYXRhLl9pZClcclxuICAgICAgOiBhcGkubGlrZUNhcmQoZGF0YS5faWQpO1xyXG5cclxuICAgIGxpa2VDYXJkUHJvbWlzZVxyXG4gICAgICAudGhlbigodXBkYXRlZENhcmQpID0+IHtcclxuICAgICAgICBjYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFxyXG4gICAgICAgICAgXCJjYXJkX19saWtlLWJ1dHRvbl9saWtlZFwiLFxyXG4gICAgICAgICAgdXBkYXRlZENhcmQuaXNMaWtlZFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgY2FyZExpa2VDb3VudC50ZXh0Q29udGVudCA9IHVwZGF0ZWRDYXJkLmlzTGlrZWQgPyBcIjFcIiA6IFwiMFwiO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIGxpa2Ugc3RhdHVzOlwiLCBlcnJvcik7XHJcbiAgICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICAvLyBkZWxldGUgYW5kIHByZXZpZXcgZXZlbnQgbGlzdGVuZXJzXHJcbiAgY2FyZERlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcclxuICAgIGRlbGV0ZUZvcm0uX2NhcmRUb0RlbGV0ZSA9IGNhcmRFbGVtZW50O1xyXG4gIH0pO1xyXG5cclxuICBjYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIG9wZW5Nb2RhbChwcmV2aWV3TW9kYWwpO1xyXG4gICAgcHJldmlld0NhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICBwcmV2aWV3SW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xyXG4gICAgcHJldmlld0ltYWdlLnNyYyA9IGRhdGEubGluaztcclxuICB9KTtcclxuXHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG5cclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlT3ZlcmxheUNsaWNrKTtcclxuICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBoYW5kbGVFc2NhcGVLZXlQcmVzcyk7XHJcblxyXG4gIG1vZGFsLl9oYW5kbGVPdmVybGF5Q2xpY2sgPSBoYW5kbGVPdmVybGF5Q2xpY2s7XHJcbiAgbW9kYWwuX2hhbmRsZUVzY2FwZUtleVByZXNzID0gaGFuZGxlRXNjYXBlS2V5UHJlc3M7XHJcblxyXG4gIGZ1bmN0aW9uIGhhbmRsZU92ZXJsYXlDbGljayhldmVudCkge1xyXG4gICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcclxuICAgICAgY2xvc2VNb2RhbChtb2RhbCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBoYW5kbGVFc2NhcGVLZXlQcmVzcyhldmVudCkge1xyXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICBjbG9zZU1vZGFsKG1vZGFsKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNsb3NlTW9kYWwobW9kYWwpIHtcclxuICBtb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG5cclxuICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgbW9kYWwuX2hhbmRsZU92ZXJsYXlDbGljayk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgbW9kYWwuX2hhbmRsZUVzY2FwZUtleVByZXNzKTtcclxufVxyXG5cclxuLy8gZnVuY3Rpb24gcmVuZGVyTG9hZGluZyhcclxuLy8gaXNMb2FkaW5nLFxyXG4vLyBidXR0b24sXHJcbi8vIGJ1dHRvblRleHQgPSBcIlNhdmVcIixcclxuLy8gbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiXHJcbi8vICkge1xyXG4vLyBidXR0b24udGV4dENvbnRlbnQgPSBpc0xvYWRpbmcgPyBsb2FkaW5nVGV4dCA6IGJ1dHRvblRleHQ7XHJcbi8vIH1cclxuXHJcbi8vIFVuaXZlcnNhbCBDbG9zZSBCdXR0b24gSGFuZGxlclxyXG5jbG9zZUJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiB7XHJcbiAgY29uc3QgbW9kYWwgPSBidXR0b24uY2xvc2VzdChcIi5tb2RhbFwiKTtcclxuICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IGNsb3NlTW9kYWwobW9kYWwpKTtcclxufSk7XHJcblxyXG4vLyBIYW5kbGVyc1xyXG5mdW5jdGlvbiBtYWtlRWRpdFByb2ZpbGVSZXF1ZXN0KCkge1xyXG4gIC8vIEdldCBmb3JtIHZhbHVlc1xyXG4gIGNvbnN0IG5hbWUgPSBlZGl0TW9kYWxOYW1lSW5wdXQudmFsdWU7XHJcbiAgY29uc3QgYWJvdXQgPSBlZGl0TW9kYWxEZXNjcmlwdGlvbklucHV0LnZhbHVlO1xyXG5cclxuICAvLyBNYWtlIEFQSSBjYWxsIHRvIGVkaXQgdXNlciBpbmZvXHJcbiAgcmV0dXJuIGFwaS5lZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KS50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgLy8gVXBkYXRlIHRoZSBET00gd2l0aCB0aGUgbmV3IHVzZXIgZGF0YVxyXG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSB1c2VyRGF0YS5uYW1lO1xyXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdXNlckRhdGEuYWJvdXQ7XHJcbiAgICAvLyBDbG9zZSB0aGUgbW9kYWxcclxuICAgIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcclxuICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgaGFuZGxlU3VibWl0KG1ha2VFZGl0UHJvZmlsZVJlcXVlc3QsIGV2dCwgXCJTYXZpbmcuLi5cIik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNhcmRGb3JtU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGNhcmRGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idXR0b25cIik7XHJcbiAgcmVuZGVyTG9hZGluZyh0cnVlLCBzdWJtaXRCdXR0b24pO1xyXG5cclxuICBhcGlcclxuICAgIC5hZGRDYXJkKHtcclxuICAgICAgbmFtZTogY2FyZENhcHRpb25JbnB1dC52YWx1ZSxcclxuICAgICAgbGluazogY2FyZExpbmtJbnB1dC52YWx1ZSxcclxuICAgIH0pXHJcbiAgICAudGhlbigoY2FyZERhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkRGF0YSk7XHJcbiAgICAgIGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIHN1Ym1pdEJ1dHRvbik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy8gRWRpdCBNb2RhbCBMaXN0ZW5lcnNcclxuZWRpdE1vZGFsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZWRpdE1vZGFsTmFtZUlucHV0LnZhbHVlID0gcHJvZmlsZU5hbWUudGV4dENvbnRlbnQ7XHJcbiAgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudDtcclxuICByZXNldFZhbGlkYXRpb24oXHJcbiAgICBlZGl0Rm9ybSxcclxuICAgIFtlZGl0TW9kYWxOYW1lSW5wdXQsIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXRdLFxyXG4gICAgc2V0dGluZ3NcclxuICApO1xyXG4gIG9wZW5Nb2RhbChlZGl0TW9kYWwpO1xyXG59KTtcclxuXHJcbi8vIEF2YXRhciBNb2RhbCBMaXN0ZW5lclxyXG5hdmF0YXJFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgb3Blbk1vZGFsKGF2YXRhck1vZGFsKTtcclxufSk7XHJcblxyXG4vLyBDYXJkIE1vZGFsIExpc3RlbmVyc1xyXG5jYXJkTW9kYWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBvcGVuTW9kYWwoY2FyZE1vZGFsKTtcclxufSk7XHJcblxyXG5jYW5jZWxEZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufSk7XHJcblxyXG4vLyBGb3JtIExpc3RlbmVyc1xyXG5lZGl0Rm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRGb3JtU3VibWl0KTtcclxuY2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVDYXJkRm9ybVN1Ym1pdCk7XHJcblxyXG5kZWxldGVGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGRlbGV0ZUZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcclxuICByZW5kZXJMb2FkaW5nKHRydWUsIHN1Ym1pdEJ1dHRvbiwgXCJEZWxldGVcIiwgXCJEZWxldGluZy4uLlwiKTtcclxuXHJcbiAgYXBpXHJcbiAgICAucmVtb3ZlQ2FyZChkZWxldGVGb3JtLl9jYXJkVG9EZWxldGUuX2lkKSAvLyBDaGFuZ2VkIGZyb20gZGVsZXRlQ2FyZCB0byByZW1vdmVDYXJkXHJcbiAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgIGhhbmRsZVN1Ym1pdCgoKSA9PiB7XHJcbiAgICAgICAgZGVsZXRlRm9ybS5fY2FyZFRvRGVsZXRlLnJlbW92ZSgpO1xyXG4gICAgICB9KTtcclxuICAgICAgY2xvc2VNb2RhbChkZWxldGVNb2RhbCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHJlbmRlckxvYWRpbmcoZmFsc2UsIHN1Ym1pdEJ1dHRvbiwgXCJEZWxldGVcIik7XHJcbiAgICB9KTtcclxufSk7XHJcblxyXG4vLyBBdmF0YXIgRm9ybSBTdWJtaXQgSGFuZGxlclxyXG5hdmF0YXJGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGF2YXRhckZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc3VibWl0LWJ1dHRvblwiKTtcclxuICByZW5kZXJMb2FkaW5nKHRydWUsIHN1Ym1pdEJ1dHRvbik7XHJcblxyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZUF2YXRhcih7XHJcbiAgICAgIGF2YXRhcjogYXZhdGFyTGlua0lucHV0LnZhbHVlLFxyXG4gICAgfSlcclxuICAgIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHVzZXJEYXRhLmF2YXRhcjtcclxuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcmVuZGVyTG9hZGluZyhmYWxzZSwgc3VibWl0QnV0dG9uKTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG4iLCJjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgX3JlcXVlc3QoZW5kcG9pbnQsIG9wdGlvbnMgPSB7fSkge1xyXG4gICAgY29uc3QgZmluYWxPcHRpb25zID0ge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAuLi5vcHRpb25zLFxyXG4gICAgfTtcclxuICAgIGNvbnN0IHVybCA9IGAke3RoaXMuX2Jhc2VVcmx9JHtlbmRwb2ludH1gO1xyXG4gICAgcmV0dXJuIGZldGNoKHVybCwgZmluYWxPcHRpb25zKS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi91c2Vycy9tZVwiKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL2NhcmRzXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQQVRDSCAvdXNlcnMvbWVcclxuICBlZGl0VXNlckluZm8oeyBuYW1lLCBhYm91dCB9KSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGFib3V0IH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBQQVRDSCAvdXNlcnMvbWUvYXZhdGFyXHJcbiAgdXBkYXRlQXZhdGFyKHsgYXZhdGFyIH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiL3VzZXJzL21lL2F2YXRhclwiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhciB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gUE9TVCAvY2FyZHNcclxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi9jYXJkc1wiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZSwgbGluayB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gREVMRVRFIC9jYXJkcy86Y2FyZElkXHJcbiAgcmVtb3ZlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICAvLyBQVVQgL2NhcmRzLzpjYXJkSWQvbGlrZXNcclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAvY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIERFTEVURSAvY2FyZHMvOmNhcmRJZC9saWtlc1xyXG4gIGRpc2xpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYC9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gSGVscGVyOiBGZXRjaCBpbml0aWFsIGRhdGEgc2ltdWx0YW5lb3VzbHkgKHVzZXIgaW5mbyAmIGNhcmRzKVxyXG4gIGZldGNoSW5pdGlhbERhdGEoKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0VXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgQXBpO1xyXG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJsb2dFcnJvciIsIm1lc3NhZ2UiLCJjb25zb2xlIiwiZXJyb3IiLCJoaWRlSW5wdXRFcnJvciIsImZvcm1FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiY29uZmlnIiwiZXJyb3JNZXNzYWdlRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpZCIsInRleHRDb250ZW50IiwicmVtb3ZlQXR0cmlidXRlIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dExpc3QiLCJidXR0b25FbGVtZW50Iiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImFkZCIsInJlc2V0VmFsaWRhdGlvbiIsImZvckVhY2giLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwiYnV0dG9uIiwiYnV0dG9uVGV4dCIsImxvYWRpbmdUZXh0IiwiaGFuZGxlU3VibWl0IiwicmVxdWVzdCIsImV2dCIsInByZXZlbnREZWZhdWx0Iiwic3VibWl0QnV0dG9uIiwic3VibWl0dGVyIiwiaW5pdGlhbFRleHQiLCJjYXRjaCIsImZpbmFsbHkiLCJkb2N1bWVudCIsInNyYyIsImxvZ29QYXRoIiwiYXZhdGFyUGF0aCIsImVkaXRCdXR0b25QYXRoIiwiYWRkQnV0dG9uUGF0aCIsImVkaXRMaWdodEJ1dHRvblBhdGgiLCJhcGkiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJ0aGlzIiwiX2Jhc2VVcmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJlbmRwb2ludCIsImZpbmFsT3B0aW9ucyIsInVybCIsImZldGNoIiwidGhlbiIsImdldFVzZXJJbmZvIiwiZ2V0SW5pdGlhbENhcmRzIiwibWV0aG9kIiwiZWRpdFVzZXJJbmZvIiwibmFtZSIsImFib3V0IiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXIiLCJhZGRDYXJkIiwibGluayIsInJlbW92ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsImRpc2xpa2VDYXJkIiwiZmV0Y2hJbml0aWFsRGF0YSIsImFsbCIsImF1dGhvcml6YXRpb24iLCJ1c2VySWQiLCJ1c2VyRGF0YSIsIl9pZCIsInByb2ZpbGVOYW1lIiwicHJvZmlsZURlc2NyaXB0aW9uIiwicHJvZmlsZUF2YXRhciIsImNhcmRzIiwiY2FyZCIsImNhcmRFbGVtZW50IiwiZ2V0Q2FyZEVsZW1lbnQiLCJjYXJkc0xpc3QiLCJhcHBlbmQiLCJlZGl0TW9kYWxCdXR0b24iLCJjYXJkTW9kYWxCdXR0b24iLCJjbG9zZUJ1dHRvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZGVsZXRlTW9kYWwiLCJkZWxldGVGb3JtIiwiY2FuY2VsRGVsZXRlQnV0dG9uIiwiYXZhdGFyRWRpdEJ1dHRvbiIsImF2YXRhck1vZGFsIiwiYXZhdGFyRm9ybSIsImF2YXRhckxpbmtJbnB1dCIsImVkaXRNb2RhbCIsImVkaXRGb3JtIiwiZWRpdE1vZGFsTmFtZUlucHV0IiwiZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dCIsImNhcmRNb2RhbCIsImNhcmRGb3JtIiwiY2FyZExpbmtJbnB1dCIsImNhcmRDYXB0aW9uSW5wdXQiLCJwcmV2aWV3TW9kYWwiLCJwcmV2aWV3SW1hZ2UiLCJwcmV2aWV3Q2FwdGlvbiIsImNhcmRUZW1wbGF0ZSIsImRhdGEiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZFRpdGxlIiwiY2FyZEltYWdlIiwiY2FyZExpa2VCdXR0b24iLCJjYXJkTGlrZUNvdW50IiwiY2FyZERlbGV0ZUJ1dHRvbiIsImFsdCIsImlzTGlrZWQiLCJhZGRFdmVudExpc3RlbmVyIiwiY29udGFpbnMiLCJ1cGRhdGVkQ2FyZCIsInRvZ2dsZSIsIm9wZW5Nb2RhbCIsIl9jYXJkVG9EZWxldGUiLCJtb2RhbCIsImhhbmRsZU92ZXJsYXlDbGljayIsImV2ZW50IiwidGFyZ2V0IiwiY2xvc2VNb2RhbCIsImhhbmRsZUVzY2FwZUtleVByZXNzIiwia2V5IiwiX2hhbmRsZU92ZXJsYXlDbGljayIsIl9oYW5kbGVFc2NhcGVLZXlQcmVzcyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJtYWtlRWRpdFByb2ZpbGVSZXF1ZXN0IiwidmFsdWUiLCJjbG9zZXN0IiwiY2FyZERhdGEiLCJwcmVwZW5kIiwicmVzZXQiLCJBcnJheSIsImZyb20iLCJzZXRFdmVudExpc3RlbmVycyIsImNoZWNrSW5wdXRWYWxpZGl0eSIsInNob3dJbnB1dEVycm9yIiwiZXJyb3JNZXNzYWdlIiwic2V0QXR0cmlidXRlIiwidmFsaWRhdGlvbk1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9